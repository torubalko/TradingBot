#pragma once
#include <memory>
#include <thread>
#include <atomic>
#include <string>

#include "SharedState.h"
#include "BinanceConnector.h"
#include "Types.h"

namespace TradingBot::Core {

    // ???????????????????????????????????????????????????????????????
    // TradingBotApplication: Упрощённая версия для компиляции
    // ???????????????????????????????????????????????????????????????

    class TradingBotApplication {
    public:
        TradingBotApplication();
        ~TradingBotApplication();

        bool Initialize(const std::string& configPath);
        void Start();
        void Stop();
        void Run();

        // Доступ к SharedState для UI
        std::shared_ptr<SharedState> GetSharedState() const { return sharedState_; }

    private:
        void MainThreadLoop();
        void TelemetryThreadLoop();
        void GracefulShutdown();

        std::shared_ptr<SharedState> sharedState_;
        std::unique_ptr<Network::BinanceConnector> binanceConnector_;

        std::atomic<bool> running_{false};
        std::thread telemetryThread_;
    };

} // namespace TradingBot::Core
