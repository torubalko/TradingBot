#pragma once
#include <string>

namespace TradingBot::Core::Trading {

    // ???????????????????????????????????????????????????????????????
    // ApiConfig: Конфигурация API ключей и endpoints
    // ???????????????????????????????????????????????????????????????
    struct ApiConfig {
        // API Keys (хранятся в памяти, загружаются из config файла)
        std::string apiKey;
        std::string secretKey;

        // Endpoints
        std::string spotHost{"testnet.binance.vision"};      // Testnet Spot
        std::string futuresHost{"testnet.binancefuture.com"}; // Testnet Futures

        // WebSocket endpoints
        std::string wsSpotHost{"testnet.binance.vision"};
        std::string wsFuturesHost{"fstream.binancefuture.com"};

        // Режим работы
        bool isTestnet{true};

        // Таймауты
        int connectionTimeoutMs{5000};
        int requestTimeoutMs{10000};

        // Retry settings
        int maxRetries{3};
        int retryDelayMs{1000};

        // ???????????????????????????????????????????????????????????????
        // Production endpoints (будут использоваться при isTestnet = false)
        // ???????????????????????????????????????????????????????????????
        void UseProductionEndpoints() {
            isTestnet = false;
            spotHost = "api.binance.com";
            futuresHost = "fapi.binance.com";
            wsSpotHost = "stream.binance.com";
            wsFuturesHost = "fstream.binance.com";
        }

        // ???????????????????????????????????????????????????????????????
        // Validation
        // ???????????????????????????????????????????????????????????????
        bool IsValid() const {
            // Для testnet API ключи не обязательны (public endpoints)
            if (isTestnet) {
                return !spotHost.empty();
            }

            // Для production требуются API ключи
            return !apiKey.empty() && !secretKey.empty() && !spotHost.empty();
        }

        // ???????????????????????????????????????????????????????????????
        // Load from file (TODO: реализовать парсинг JSON/TOML config)
        // ???????????????????????????????????????????????????????????????
        static ApiConfig LoadFromFile(const std::string& configPath) {
            ApiConfig config;

            // TODO: Загрузка из config.json:
            // {
            //   "apiKey": "your_api_key",
            //   "secretKey": "your_secret_key",
            //   "isTestnet": true
            // }

            // Пока возвращаем дефолтный testnet config
            config.isTestnet = true;
            config.spotHost = "testnet.binance.vision";

            return config;
        }
    };

} // namespace TradingBot::Core::Trading
