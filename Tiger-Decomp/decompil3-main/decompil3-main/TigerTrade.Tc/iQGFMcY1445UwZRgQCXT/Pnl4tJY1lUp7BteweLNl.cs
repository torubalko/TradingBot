using System;
using System.ComponentModel;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using BfZtb759KlUg4482QKym;
using K1GcsD5GTtMSlaiJI0Xh;
using TigerTrade.Core.Utils.Logging;
using x97CE55GhEYKgt7TSVZT;

namespace iQGFMcY1445UwZRgQCXT;

internal sealed class Pnl4tJY1lUp7BteweLNl
{
	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate bool sXHkZ1aW9nsGnxD4WB4N(UDoDmOaWBmUfoEKka5xL callback);

	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate IntPtr er4UqPaWn6JgcecFpijA(byte[] data);

	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate bool W4VHVLaWGiyLskaxHfMp(IntPtr data);

	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate IntPtr lhdvcBaWY8ZLXKNc2jYq(byte[] logPath, int logLevel);

	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate IntPtr nBMetvaWoYGpsNXpHGrN();

	[UnmanagedFunctionPointer(CallingConvention.StdCall, CharSet = CharSet.Ansi)]
	private delegate IntPtr n0vKPwaWv8rWclAZC3BG(int logLevel);

	private delegate bool UDoDmOaWBmUfoEKka5xL(IntPtr data);

	[StructLayout(LayoutKind.Sequential, Pack = 1)]
	private struct Rl1imDaWaeBFOG9jZbSx
	{
		[MarshalAs(UnmanagedType.LPUTF8Str)]
		public string TnfaWiZCZBr;
	}

	public delegate void A9F6HiaWl6FtWuQqbyvO(string str);

	private readonly sXHkZ1aW9nsGnxD4WB4N troY1sQAYip;

	private readonly er4UqPaWn6JgcecFpijA L92Y1XLMJop;

	private readonly W4VHVLaWGiyLskaxHfMp nDmY1cexZrO;

	private readonly lhdvcBaWY8ZLXKNc2jYq FbOY1jNjUvS;

	private readonly nBMetvaWoYGpsNXpHGrN oQnY1EHPrxT;

	private readonly n0vKPwaWv8rWclAZC3BG nXXY1QTWYjS;

	private readonly IntPtr HtSY1dD1sP4;

	private object dsuY1g6VHEn;

	private A9F6HiaWl6FtWuQqbyvO FKTY1Rcbcni;

	private UDoDmOaWBmUfoEKka5xL fEyY16ws462;

	private bool KLlY1MMP1J3;

	private static readonly UTF8Encoding xqUY1Oe74qT;

	private static Pnl4tJY1lUp7BteweLNl dtI30oSlKStLM9GyMPeV;

	[DllImport("kernel32.dll", EntryPoint = "LoadLibrary", SetLastError = true)]
	private static extern IntPtr AfCY1D2yyHt(string P_0);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, EntryPoint = "GetProcAddress", SetLastError = true)]
	private static extern IntPtr S6NY1bkf5Rx(IntPtr P_0, string P_1);

	[DllImport("kernel32.dll", EntryPoint = "FreeLibrary", SetLastError = true)]
	private static extern bool fnZY1NYU9gk(IntPtr P_0);

	private static IntPtr YgDY1kQitmG(IntPtr P_0, string P_1)
	{
		IntPtr intPtr = S6NY1bkf5Rx(P_0, P_1);
		if (intPtr == IntPtr.Zero)
		{
			throw new Win32Exception(Marshal.GetLastWin32Error(), P_1 + (string)kE6T4SSlwOnVvHvG3A2R(--871424829 ^ 0x33F1AA13));
		}
		return intPtr;
	}

	private AjdpWDktoRxELsc1hRpl Os4Y11y0V95<AjdpWDktoRxELsc1hRpl>(string P_0)
	{
		IntPtr intPtr = YgDY1kQitmG(HtSY1dD1sP4, P_0);
		if (intPtr == IntPtr.Zero)
		{
			return default(AjdpWDktoRxELsc1hRpl);
		}
		return Marshal.GetDelegateForFunctionPointer<AjdpWDktoRxELsc1hRpl>(intPtr);
	}

	static Pnl4tJY1lUp7BteweLNl()
	{
		SimAfmSl70BPjGNfDwyB();
		pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
		itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
		int num = 0;
		if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_863ddca33ab24df3a8c9a4e42ae6cbdc == 0)
		{
			num = 0;
		}
		switch (num)
		{
		}
		xqUY1Oe74qT = new UTF8Encoding();
	}

	public Pnl4tJY1lUp7BteweLNl(string P_0, bool P_1)
	{
		itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
		dsuY1g6VHEn = new object();
		base._002Ector();
		int num = 0;
		if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_bdd0830849fd42b0a6744b7ce88daa30 == 0)
		{
			num = 0;
		}
		while (true)
		{
			switch (num)
			{
			case 1:
				nDmY1cexZrO = Os4Y11y0V95<W4VHVLaWGiyLskaxHfMp>(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(0x706541F3 ^ 0x70640889));
				FbOY1jNjUvS = Os4Y11y0V95<lhdvcBaWY8ZLXKNc2jYq>((string)kE6T4SSlwOnVvHvG3A2R(-624753169 ^ -624800643));
				oQnY1EHPrxT = Os4Y11y0V95<nBMetvaWoYGpsNXpHGrN>(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(--927068468 ^ 0x3740B89E));
				nXXY1QTWYjS = Os4Y11y0V95<n0vKPwaWv8rWclAZC3BG>(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(-165474503 ^ -165525761));
				num = 4;
				break;
			case 3:
				troY1sQAYip = Os4Y11y0V95<sXHkZ1aW9nsGnxD4WB4N>(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(0x24085900 ^ 0x24091046));
				L92Y1XLMJop = Os4Y11y0V95<er4UqPaWn6JgcecFpijA>(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(0x7394D272 ^ 0x73959B12));
				num = 1;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_18fbecec0dfa44d6afb647cf0f10b685 != 0)
				{
					num = 0;
				}
				break;
			case 4:
				return;
			case 2:
				throw new Win32Exception(Marshal.GetLastWin32Error());
			default:
			{
				IntPtr intPtr = AfCY1D2yyHt(Path.Combine(P_0, (string)(Environment.Is64BitProcess ? (P_1 ? kE6T4SSlwOnVvHvG3A2R(-2063361985 ^ -2063422249) : F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(-1047165041 ^ -1047219407)) : (P_1 ? F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(-1346994499 ^ -1346942401) : F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(-1799510641 ^ -1799581229)))));
				if (!gtnGGsSl8Qjory1My6LU(intPtr, IntPtr.Zero))
				{
					HtSY1dD1sP4 = intPtr;
					int num2 = 3;
					num = num2;
					break;
				}
				goto case 2;
			}
			}
		}
	}

	public void C4QY155fPnC(A9F6HiaWl6FtWuQqbyvO P_0, string P_1, int P_2)
	{
		if (KLlY1MMP1J3)
		{
			return;
		}
		P_2 = EkIuAnSlAREs8VCSslOM(1, Math.Min(3, P_2));
		int num = 0;
		if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_67356183f8464ca6962cfffbcb53813d != 0)
		{
			num = 0;
		}
		while (true)
		{
			switch (num)
			{
			case 1:
				FKTY1Rcbcni = P_0;
				fEyY16ws462 = pU4Y1x1XWaG;
				KLlY1MMP1J3 = wsmnRBSlPRwW8c6ZKPqe(troY1sQAYip, fEyY16ws462);
				return;
			}
			FbOY1jNjUvS(xqUY1Oe74qT.GetBytes(P_1), P_2);
			num = 1;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_21ad277cd47f4cf3b51c372634d8f584 == 0)
			{
				num = 1;
			}
		}
	}

	public string TjFY1SgFm6F(string P_0)
	{
		object obj = dsuY1g6VHEn;
		bool lockTaken = false;
		try
		{
			Monitor.Enter(obj, ref lockTaken);
			_ = string.Empty;
			try
			{
				byte[] array = (byte[])VPN9kLSlJxLpm2kQPH82(xqUY1Oe74qT, P_0);
				IntPtr intPtr = twPD1GSlFZLjP9Dmfo7C(L92Y1XLMJop, array);
				int num = 0;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_4f84702cc6834fdb9f44daed1fd8e55b == 0)
				{
					num = 0;
				}
				return num switch
				{
					_ => KNDY1L7BPZG(intPtr), 
				};
			}
			catch (Exception e)
			{
				LogManager.WriteError(e);
				return null;
			}
		}
		finally
		{
			if (lockTaken)
			{
				UjGRB9Sl37QXLRBJGwoK(obj);
			}
		}
	}

	private bool pU4Y1x1XWaG(IntPtr P_0)
	{
		string str = KNDY1L7BPZG(P_0);
		A9F6HiaWl6FtWuQqbyvO fKTY1Rcbcni = FKTY1Rcbcni;
		if (fKTY1Rcbcni != null)
		{
			fKTY1Rcbcni(str);
			int num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_09c5bd75193a4fbe995d693b67f9f226 != 0)
			{
				num = 0;
			}
			switch (num)
			{
			}
		}
		return true;
	}

	private string KNDY1L7BPZG(IntPtr P_0)
	{
		try
		{
			return Marshal.PtrToStructure<Rl1imDaWaeBFOG9jZbSx>(P_0).TnfaWiZCZBr;
		}
		finally
		{
			nDmY1cexZrO(P_0);
		}
	}

	public void jLmY1eqJBYP()
	{
		try
		{
			int num;
			if (!KLlY1MMP1J3)
			{
				num = 1;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_99445506e7fb4478b8370a949ce4a2a6 == 0)
				{
					num = 1;
				}
				goto IL_0030;
			}
			oQnY1EHPrxT();
			goto IL_0042;
			IL_0030:
			switch (num)
			{
			default:
				return;
			case 0:
				return;
			case 1:
				break;
			}
			goto IL_0042;
			IL_0042:
			if (!(HtSY1dD1sP4 != IntPtr.Zero))
			{
				return;
			}
			fnZY1NYU9gk(HtSY1dD1sP4);
			num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_13a5ccb7e7c94d3d800c9001e431102c != 0)
			{
				num = 0;
			}
			goto IL_0030;
		}
		catch (Exception e)
		{
			LogManager.WriteError(e);
		}
	}

	internal static object kE6T4SSlwOnVvHvG3A2R(int P_0)
	{
		return F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(P_0);
	}

	internal static bool SfRSGkSlmMqQ0BcYyPk2()
	{
		return dtI30oSlKStLM9GyMPeV == null;
	}

	internal static Pnl4tJY1lUp7BteweLNl ttBMhUSlhuhw6ZOa8vom()
	{
		return dtI30oSlKStLM9GyMPeV;
	}

	internal static void SimAfmSl70BPjGNfDwyB()
	{
		F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
	}

	internal static bool gtnGGsSl8Qjory1My6LU(IntPtr P_0, IntPtr P_1)
	{
		return P_0 == P_1;
	}

	internal static int EkIuAnSlAREs8VCSslOM(int P_0, int P_1)
	{
		return Math.Max(P_0, P_1);
	}

	internal static bool wsmnRBSlPRwW8c6ZKPqe(object P_0, object P_1)
	{
		return P_0((UDoDmOaWBmUfoEKka5xL)P_1);
	}

	internal static object VPN9kLSlJxLpm2kQPH82(object P_0, object P_1)
	{
		return ((Encoding)P_0).GetBytes((string)P_1);
	}

	internal static IntPtr twPD1GSlFZLjP9Dmfo7C(object P_0, object P_1)
	{
		return P_0((byte[])P_1);
	}

	internal static void UjGRB9Sl37QXLRBJGwoK(object P_0)
	{
		Monitor.Exit(P_0);
	}
}
