using System;
using System.Collections.Concurrent;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Threading;
using BfZtb759KlUg4482QKym;
using EyD6NKGhRYBSlyBqPfrJ;
using K1GcsD5GTtMSlaiJI0Xh;
using x97CE55GhEYKgt7TSVZT;

namespace uyZAkjGzbty6fP4YlLSY;

internal sealed class UETH72GzDcyNAirT5ahJ : IDisposable
{
	private sealed class yPkfp3aqUDr3tWcpC4UN
	{
		[CompilerGenerated]
		private sealed class qoP2P5ivYWV0XsuTnhiL
		{
			public double? DoDivvTjPGt;

			public long qQcivBMPwLv;

			private static qoP2P5ivYWV0XsuTnhiL hMMMPYLMeynaIuMwPEWP;

			public qoP2P5ivYWV0XsuTnhiL()
			{
				dP7KAQLMc3UtLOFs8mJh();
				base._002Ector();
			}

			internal (double?, long) iGBivoJ3E15(string key, (double? rate, long nextMs) oldValue)
			{
				return (DoDivvTjPGt, qQcivBMPwLv);
			}

			static qoP2P5ivYWV0XsuTnhiL()
			{
				F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
				CZBc5HLMje0mEWmf4KZ4();
			}

			internal static void dP7KAQLMc3UtLOFs8mJh()
			{
				itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
			}

			internal static bool f4d5eDLMsFYd2oyLHUCc()
			{
				return hMMMPYLMeynaIuMwPEWP == null;
			}

			internal static qoP2P5ivYWV0XsuTnhiL uV2qLILMXpexb1wLY8iM()
			{
				return hMMMPYLMeynaIuMwPEWP;
			}

			internal static void CZBc5HLMje0mEWmf4KZ4()
			{
				pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
			}
		}

		[Serializable]
		[CompilerGenerated]
		private sealed class pCl3BoivaywaMjePJDVA
		{
			public static readonly pCl3BoivaywaMjePJDVA JD4iv4MCQ2p;

			public static Func<(double?, long), bool> ysfivD2NlKq;

			public static Func<(double?, long), long> nRVivbnFLuc;

			internal static pCl3BoivaywaMjePJDVA ssTQJkLMEvUAeyZZn7aF;

			static pCl3BoivaywaMjePJDVA()
			{
				F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
				pIRC1BLMgxtQC6eaWvBX();
				int num = 0;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_137abeaac6b54c2d909c4f75bdf9527a != 0)
				{
					num = 0;
				}
				switch (num)
				{
				}
				jMywkeLMR5RhUxhfP13X();
				JD4iv4MCQ2p = new pCl3BoivaywaMjePJDVA();
			}

			public pCl3BoivaywaMjePJDVA()
			{
				itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
				base._002Ector();
			}

			internal bool rJQivi9JMPd((double? rate, long nextMs) x)
			{
				return x.nextMs > 0;
			}

			internal long ARVivlivQhk((double? rate, long nextMs) x)
			{
				return x.nextMs;
			}

			internal static void pIRC1BLMgxtQC6eaWvBX()
			{
				pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
			}

			internal static void jMywkeLMR5RhUxhfP13X()
			{
				itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
			}

			internal static bool Y6fIUGLMQ5d45GSDe5L3()
			{
				return ssTQJkLMEvUAeyZZn7aF == null;
			}

			internal static pCl3BoivaywaMjePJDVA efDVuLLMd4rCa1TVkHjg()
			{
				return ssTQJkLMEvUAeyZZn7aF;
			}
		}

		private readonly ConcurrentDictionary<string, (double?, long)> UISaqmw8GN9;

		private string wKgaqhXeSQX;

		private long QG0aqwrURei;

		internal static yPkfp3aqUDr3tWcpC4UN UJgCVcxzagxo16TO20tn;

		[SpecialName]
		public bool HJjaqrKu2S8()
		{
			return UVqcDSxz4Jw3VN76vlgy(UISaqmw8GN9);
		}

		public void oKkaqTgwkUi(string P_0, double? P_1, long P_2)
		{
			qoP2P5ivYWV0XsuTnhiL CS_0024_003C_003E8__locals6 = new qoP2P5ivYWV0XsuTnhiL();
			CS_0024_003C_003E8__locals6.DoDivvTjPGt = P_1;
			CS_0024_003C_003E8__locals6.qQcivBMPwLv = P_2;
			UISaqmw8GN9.AddOrUpdate(P_0, (CS_0024_003C_003E8__locals6.DoDivvTjPGt, CS_0024_003C_003E8__locals6.qQcivBMPwLv), (string key, (double? rate, long nextMs) oldValue) => (CS_0024_003C_003E8__locals6.DoDivvTjPGt, CS_0024_003C_003E8__locals6.qQcivBMPwLv));
		}

		public void Xy5aqyAqnDF(string P_0)
		{
			UISaqmw8GN9.TryRemove(P_0, out var _);
		}

		public void qmbaqZbIJXQ(DateTime P_0)
		{
			long num = (from x in UISaqmw8GN9.Values
				where x.nextMs > 0
				select x.nextMs).DefaultIfEmpty(0L).Min();
			int num2;
			if (num > 0)
			{
				DateTimeOffset dateTimeOffset = DateTimeOffset.FromUnixTimeMilliseconds(num);
				if (!(dateTimeOffset > P_0))
				{
					wKgaqhXeSQX = string.Empty;
					QG0aqwrURei = 0L;
					return;
				}
				TimeSpan timeSpan = MIfuBNxzDOB56PORUsWg(dateTimeOffset, P_0);
				wKgaqhXeSQX = F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(0x315AB1E3 ^ 0x315B46F5) + timeSpan.ToString(F71m3059rTj4gyFcUtWX.JNO5no2YvQQ(0x4297C3EB ^ 0x429634CB));
				QG0aqwrURei = num;
				num2 = 3;
			}
			else
			{
				num2 = 0;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_067bb9a4251b4173906596508c60e32c != 0)
				{
					num2 = 2;
				}
			}
			while (true)
			{
				switch (num2)
				{
				default:
					return;
				case 2:
					wKgaqhXeSQX = string.Empty;
					num2 = 1;
					if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_db475a540dcc44d9a72c3f197bb7b1f7 != 0)
					{
						num2 = 0;
					}
					break;
				case 0:
					return;
				case 3:
					return;
				case 1:
					QG0aqwrURei = 0L;
					num2 = 0;
					if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_a00a0a595d0940febaa0173bc44df36c == 0)
					{
						num2 = 0;
					}
					break;
				}
			}
		}

		public string VXeaqVo0jhj()
		{
			return wKgaqhXeSQX;
		}

		public long cw9aqCn5qwB()
		{
			return QG0aqwrURei;
		}

		public yPkfp3aqUDr3tWcpC4UN()
		{
			itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
			UISaqmw8GN9 = new ConcurrentDictionary<string, (double?, long)>();
			wKgaqhXeSQX = string.Empty;
			base._002Ector();
			int num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_7b7109b795404d83aab2ffb6bac7cdab == 0)
			{
				num = 0;
			}
			switch (num)
			{
			case 0:
				break;
			}
		}

		static yPkfp3aqUDr3tWcpC4UN()
		{
			F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
			pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
		}

		internal static bool UVqcDSxz4Jw3VN76vlgy(object P_0)
		{
			return ((ConcurrentDictionary<string, (double?, long)>)P_0).IsEmpty;
		}

		internal static bool NbcDmjxzi0B5WaBuEijy()
		{
			return UJgCVcxzagxo16TO20tn == null;
		}

		internal static yPkfp3aqUDr3tWcpC4UN aKXYeoxzlRSnjpS1AOgU()
		{
			return UJgCVcxzagxo16TO20tn;
		}

		internal static TimeSpan MIfuBNxzDOB56PORUsWg(DateTimeOffset P_0, DateTimeOffset P_1)
		{
			return P_0 - P_1;
		}
	}

	[CompilerGenerated]
	private sealed class ocmMgKaq7j7sTeqgDxUM
	{
		public long UP8aqA7wBPs;

		private static ocmMgKaq7j7sTeqgDxUM ku7P7ZxzbEmE9cAbMwu7;

		public ocmMgKaq7j7sTeqgDxUM()
		{
			nVoUCaxz19SE2onyD92f();
			base._002Ector();
		}

		internal long n4Oaq8ypOFT(string key, long oldValue)
		{
			return UP8aqA7wBPs;
		}

		static ocmMgKaq7j7sTeqgDxUM()
		{
			F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
			zi9h4Yxz56Ci9P6lBO1o();
		}

		internal static void nVoUCaxz19SE2onyD92f()
		{
			itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
		}

		internal static bool FyeysgxzNwEi10LI24iJ()
		{
			return ku7P7ZxzbEmE9cAbMwu7 == null;
		}

		internal static ocmMgKaq7j7sTeqgDxUM dy3TkFxzkyePFD4Hy64Q()
		{
			return ku7P7ZxzbEmE9cAbMwu7;
		}

		internal static void zi9h4Yxz56Ci9P6lBO1o()
		{
			pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
		}
	}

	[Serializable]
	[CompilerGenerated]
	private sealed class tWDO8XaqPJFMDQBr0h9A
	{
		public static readonly tWDO8XaqPJFMDQBr0h9A o19aq3IbeZ6;

		public static Func<long, yPkfp3aqUDr3tWcpC4UN> KYraqpYWO03;

		public static Func<yPkfp3aqUDr3tWcpC4UN, long> oyTaquehnc5;

		private static tWDO8XaqPJFMDQBr0h9A a77jyDxzST2O53tRi4fy;

		static tWDO8XaqPJFMDQBr0h9A()
		{
			int num = 1;
			int num2 = num;
			while (true)
			{
				switch (num2)
				{
				case 1:
					GKqWh7xzehyVaV868fSa();
					num2 = 0;
					if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_1100fc9af5ab4ad2ab8cefa34e531240 == 0)
					{
						num2 = 0;
					}
					break;
				default:
					pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
					itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
					o19aq3IbeZ6 = new tWDO8XaqPJFMDQBr0h9A();
					return;
				}
			}
		}

		public tWDO8XaqPJFMDQBr0h9A()
		{
			itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
			base._002Ector();
		}

		internal yPkfp3aqUDr3tWcpC4UN OiyaqJBMu19(long interval)
		{
			return new yPkfp3aqUDr3tWcpC4UN();
		}

		internal long LrgaqFFsNvT(yPkfp3aqUDr3tWcpC4UN g)
		{
			return g.cw9aqCn5qwB();
		}

		internal static void GKqWh7xzehyVaV868fSa()
		{
			F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
		}

		internal static bool obfmBExzxmqySgUYO60a()
		{
			return a77jyDxzST2O53tRi4fy == null;
		}

		internal static tWDO8XaqPJFMDQBr0h9A AcbVD6xzLT8u9ZuJ3bmQ()
		{
			return a77jyDxzST2O53tRi4fy;
		}
	}

	private static UETH72GzDcyNAirT5ahJ TlNGzXvL8GG;

	private readonly ConcurrentDictionary<long, yPkfp3aqUDr3tWcpC4UN> QIQGzc9wBIg;

	private readonly ConcurrentDictionary<string, long> eylGzj8YdNy;

	private readonly Timer yLlGzEfArLm;

	private bool NMhGzQy8VTX;

	internal static UETH72GzDcyNAirT5ahJ SuO5mp5J7FR1fnOGrs3u;

	[SpecialName]
	public static UETH72GzDcyNAirT5ahJ E09GzekvJKi()
	{
		return TlNGzXvL8GG ?? (TlNGzXvL8GG = new UETH72GzDcyNAirT5ahJ());
	}

	private UETH72GzDcyNAirT5ahJ()
	{
		itlbck5GUdCiQcy9cfLX.MSJLykDwaZf();
		QIQGzc9wBIg = new ConcurrentDictionary<long, yPkfp3aqUDr3tWcpC4UN>();
		eylGzj8YdNy = new ConcurrentDictionary<string, long>();
		base._002Ector();
		int num = 1;
		if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_c82b80986db149fc8e857dfed661c1a6 != 0)
		{
			num = 1;
		}
		while (true)
		{
			switch (num)
			{
			default:
				return;
			case 1:
				yLlGzEfArLm = new Timer(hUlGzxXXylu, null, TimeSpan.FromSeconds(1.0), TimeSpan.FromSeconds(1.0));
				num = 0;
				if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_5557066a01244f8e812ce68a3370995c == 0)
				{
					num = 0;
				}
				break;
			case 0:
				return;
			}
		}
	}

	public void gZNGzNGhYT9(string P_0, double? P_1, long? P_2)
	{
		ocmMgKaq7j7sTeqgDxUM CS_0024_003C_003E8__locals4 = new ocmMgKaq7j7sTeqgDxUM();
		if (string.IsNullOrEmpty(P_0))
		{
			return;
		}
		if (!P_2.HasValue || P_2.Value <= 0)
		{
			uqwGzkNw17q(P_0);
			return;
		}
		CS_0024_003C_003E8__locals4.UP8aqA7wBPs = uAwGzLC5uKq(P_2.Value);
		QIQGzc9wBIg.GetOrAdd(CS_0024_003C_003E8__locals4.UP8aqA7wBPs, (long interval) => new yPkfp3aqUDr3tWcpC4UN()).oKkaqTgwkUi(P_0, P_1, P_2.Value);
		eylGzj8YdNy.AddOrUpdate(P_0, CS_0024_003C_003E8__locals4.UP8aqA7wBPs, (string key, long oldValue) => CS_0024_003C_003E8__locals4.UP8aqA7wBPs);
	}

	private void uqwGzkNw17q(string P_0)
	{
		int num = 2;
		int num2 = num;
		long value = default(long);
		while (true)
		{
			switch (num2)
			{
			case 1:
				return;
			case 2:
				if (!string.IsNullOrEmpty(P_0))
				{
					if (!eylGzj8YdNy.TryRemove(P_0, out value))
					{
						return;
					}
					num2 = 0;
					if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_6914a7e965794704a147f3749924962d == 0)
					{
						num2 = 0;
					}
				}
				else
				{
					num2 = 1;
					if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_7ea79d38f01f491fa0470ff9768a1574 == 0)
					{
						num2 = 0;
					}
				}
				continue;
			}
			if (QIQGzc9wBIg.TryGetValue(value, out var value2))
			{
				value2.Xy5aqyAqnDF(P_0);
				if (value2.HJjaqrKu2S8())
				{
					QIQGzc9wBIg.TryRemove(value, out var _);
				}
			}
			return;
		}
	}

	public string T88Gz1CNSgl(string P_0)
	{
		if (HyKtcn5JPIFDiAQWdpWO(P_0) || !eylGzj8YdNy.TryGetValue(P_0, out var value))
		{
			return string.Empty;
		}
		if (!QIQGzc9wBIg.TryGetValue(value, out var value2))
		{
			int num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_57928f9519d54fffa57a74bbdde213e4 == 0)
			{
				num = 0;
			}
			return num switch
			{
				_ => string.Empty, 
			};
		}
		return value2.VXeaqVo0jhj();
	}

	public long urBGz564GUO(string P_0)
	{
		if (!HyKtcn5JPIFDiAQWdpWO(P_0))
		{
			if (eylGzj8YdNy.TryGetValue(P_0, out var value))
			{
				if (!QIQGzc9wBIg.TryGetValue(value, out var value2))
				{
					return 0L;
				}
				return value2.cw9aqCn5qwB();
			}
			int num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_13355397408e4ea79e81e5e0aa0e3a16 != 0)
			{
				num = 0;
			}
			return num switch
			{
				_ => 0L, 
			};
		}
		return 0L;
	}

	public long P4wGzSnEZRV()
	{
		int num = 1;
		int num2 = num;
		while (true)
		{
			switch (num2)
			{
			default:
				if (QIQGzc9wBIg.Count != 0)
				{
					return QIQGzc9wBIg.Values.Min((yPkfp3aqUDr3tWcpC4UN g) => g.cw9aqCn5qwB());
				}
				goto IL_0068;
			case 1:
				{
					if (QIQGzc9wBIg != null)
					{
						num2 = 0;
						if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_41689ce5632e46808b581b3ddff97952 == 0)
						{
							num2 = 0;
						}
						break;
					}
					goto IL_0068;
				}
				IL_0068:
				return 0L;
			}
		}
	}

	private void hUlGzxXXylu(object P_0)
	{
		try
		{
			DateTime dateTime = DateTime.UtcNow.AddMilliseconds(Acj0FgGhg83F5A0lfPa4.q3hGwXLLhPb());
			foreach (yPkfp3aqUDr3tWcpC4UN value in QIQGzc9wBIg.Values)
			{
				PIoHNI5JJetg2YnP8Htx(value, dateTime);
			}
		}
		catch (Exception)
		{
		}
	}

	private static long uAwGzLC5uKq(long P_0)
	{
		return (P_0 + 150000) / 300000 * 300000;
	}

	public void Dispose()
	{
		if (NMhGzQy8VTX)
		{
			return;
		}
		NMhGzQy8VTX = true;
		Timer timer = yLlGzEfArLm;
		if (timer != null)
		{
			timer.Dispose();
			int num = 0;
			if (_003CModule_003E_007B68812e8e_002D4b5b_002D44f2_002D9304_002D3f1c4ea04b49_007D.m_ca333d1f5b544c679e2f04abd45bbe97 == 0)
			{
				num = 0;
			}
			switch (num)
			{
			case 0:
				break;
			}
		}
	}

	static UETH72GzDcyNAirT5ahJ()
	{
		F71m3059rTj4gyFcUtWX.xiX5n2gNr23();
		BSfa2c5JFCEhE35GpCxN();
	}

	internal static bool CfWxD85J8uRhVLUlA0Vn()
	{
		return SuO5mp5J7FR1fnOGrs3u == null;
	}

	internal static UETH72GzDcyNAirT5ahJ gNIUGo5JAoplD4RGVaMf()
	{
		return SuO5mp5J7FR1fnOGrs3u;
	}

	internal static bool HyKtcn5JPIFDiAQWdpWO(object P_0)
	{
		return string.IsNullOrEmpty((string)P_0);
	}

	internal static void PIoHNI5JJetg2YnP8Htx(object P_0, DateTime P_1)
	{
		((yPkfp3aqUDr3tWcpC4UN)P_0).qmbaqZbIJXQ(P_1);
	}

	internal static void BSfa2c5JFCEhE35GpCxN()
	{
		pBBtaj5Gmf2YibAYEwgh.kLjw4iIsCLsZtxc4lksN0j();
	}
}
