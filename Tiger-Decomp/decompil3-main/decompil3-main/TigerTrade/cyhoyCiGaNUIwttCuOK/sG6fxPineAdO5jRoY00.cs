using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Windows.Threading;
using aEpmU09nz6MEoNmc0pGJ;
using aeXChk9vAhkf7Zm8SpOk;
using ECOEgqlSad8NUJZ2Dr9n;
using Jgts7nfznYcKf4dWwwEP;
using pjO9twi2wnxVu9eTnHp;
using TigerTrade.Chart.Base;
using TigerTrade.Core.Utils.Logging;
using TigerTrade.Core.Utils.Time;
using TigerTrade.Tc.Connectors.Simulator.Player;
using TigerTrade.Tc.Data;
using TigerTrade.Tc.Manager;
using TuAMtrl1Nd3XoZQQUXf0;
using XF1Tgs90kedR1Bnx4jOX;
using XsDptMfu1TZDPkNQ2KkJ;

namespace cyhoyCiGaNUIwttCuOK;

internal sealed class sG6fxPineAdO5jRoY00
{
	private class U6JXY4nDydSARSSHWXrW
	{
		[CompilerGenerated]
		private readonly Symbol qnrnDVI82QG;

		public byte[] dCnnDCKhHk2;

		public bool nbsnDru4DCA;

		private static U6JXY4nDydSARSSHWXrW fu12LSN2DaMZvLuW9dTt;

		public Symbol Symbol
		{
			[CompilerGenerated]
			get
			{
				return qnrnDVI82QG;
			}
		}

		public U6JXY4nDydSARSSHWXrW(Symbol P_0)
		{
			bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
			base._002Ector();
			int num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_a9d70160736846b58381afc3c46699f2 == 0)
			{
				num = 0;
			}
			switch (num)
			{
			}
			qnrnDVI82QG = P_0;
		}

		static U6JXY4nDydSARSSHWXrW()
		{
			lvMFFVN2klxCr439xTWd();
		}

		internal static bool xa0KRnN2bXTRJcier9v0()
		{
			return fu12LSN2DaMZvLuW9dTt == null;
		}

		internal static U6JXY4nDydSARSSHWXrW zSG1osN2NKt6rsxOFgTa()
		{
			return fu12LSN2DaMZvLuW9dTt;
		}

		internal static void lvMFFVN2klxCr439xTWd()
		{
			stmj4Ul1bF7178khnjLy.nWrl1glAtDi();
		}
	}

	[CompilerGenerated]
	private sealed class J0blt9nDK5IECntROjxQ
	{
		public h3GPi790NINi0SKF01rq pblnDh1eWRt;

		public sG6fxPineAdO5jRoY00 OASnDwwG6Rk;

		internal static J0blt9nDK5IECntROjxQ IBsIBBN21NDkoDA7NFyL;

		public J0blt9nDK5IECntROjxQ()
		{
			G5VlslN2x1fR7YJ2U3mH();
			base._002Ector();
		}

		internal void CMdnDmSx0yV()
		{
			if ((string)DOT2dVN2LdrIGDkNU5Yf(pblnDh1eWRt.bky901AqCit()) == OASnDwwG6Rk.fnwikttFHt)
			{
				OASnDwwG6Rk.T6livHIWgB(pblnDh1eWRt.bky901AqCit().Symbol, pblnDh1eWRt.Data);
			}
		}

		static J0blt9nDK5IECntROjxQ()
		{
			stmj4Ul1bF7178khnjLy.nWrl1glAtDi();
		}

		internal static void G5VlslN2x1fR7YJ2U3mH()
		{
			bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
		}

		internal static bool Q3R4CkN259PpMj6qOXZX()
		{
			return IBsIBBN21NDkoDA7NFyL == null;
		}

		internal static J0blt9nDK5IECntROjxQ v36iCPN2St0W1nZh05iH()
		{
			return IBsIBBN21NDkoDA7NFyL;
		}

		internal static object DOT2dVN2LdrIGDkNU5Yf(object P_0)
		{
			return ((t8QNqWfz9x1DweDKl161)P_0).UyTfz4sb9ku();
		}
	}

	[Serializable]
	[CompilerGenerated]
	private sealed class L0baQVnD7kkTq4SLExJc
	{
		public static readonly L0baQVnD7kkTq4SLExJc P9CnD3hlyUH;

		public static Func<U6JXY4nDydSARSSHWXrW, bool> uk6nDpybSZo;

		public static Func<U6JXY4nDydSARSSHWXrW, bool> sBDnDucPQHQ;

		public static Func<MPdIMTi0styk2MD4qWM, string> VDsnDzPH39f;

		public static Func<MPdIMTi0styk2MD4qWM, string> KPqnb0S0lwZ;

		public static Func<MPdIMTi0styk2MD4qWM, string> mdsnb29MZrT;

		private static L0baQVnD7kkTq4SLExJc pRbqR4N2e5MTbd8oa9pZ;

		static L0baQVnD7kkTq4SLExJc()
		{
			int num = 1;
			int num2 = num;
			while (true)
			{
				switch (num2)
				{
				case 1:
					stmj4Ul1bF7178khnjLy.nWrl1glAtDi();
					num2 = 0;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_34759ce292e54c39852852efd3a55773 == 0)
					{
						num2 = 0;
					}
					break;
				default:
					bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
					P9CnD3hlyUH = new L0baQVnD7kkTq4SLExJc();
					return;
				}
			}
		}

		public L0baQVnD7kkTq4SLExJc()
		{
			aw36fDN2cBHjrStKLoa3();
			base._002Ector();
		}

		internal bool xmmnD8MaTsW(U6JXY4nDydSARSSHWXrW i)
		{
			return !i.nbsnDru4DCA;
		}

		internal bool qYanDAckeZW(U6JXY4nDydSARSSHWXrW i)
		{
			return i.dCnnDCKhHk2 == null;
		}

		internal string HIKnDPB8UqQ(MPdIMTi0styk2MD4qWM r)
		{
			return r.Name;
		}

		internal string U01nDJb24FO(MPdIMTi0styk2MD4qWM r)
		{
			return r.OMbi9LrenC;
		}

		internal string BKLnDFPcxYf(MPdIMTi0styk2MD4qWM r)
		{
			return r.OMbi9LrenC;
		}

		internal static bool kH2mfxN2sPb0wA8EKus9()
		{
			return pRbqR4N2e5MTbd8oa9pZ == null;
		}

		internal static L0baQVnD7kkTq4SLExJc DHwX54N2XTnRnenHZxc9()
		{
			return pRbqR4N2e5MTbd8oa9pZ;
		}

		internal static void aw36fDN2cBHjrStKLoa3()
		{
			bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
		}
	}

	private readonly Dispatcher WVciiolrcX;

	private bool FcMilj35PJ;

	private int j7ti4594Z5;

	private int nFciDJUlEF;

	private DateTime skxib6fuDN;

	private HashSet<string> XWeiNaoKc9;

	private string fnwikttFHt;

	private readonly Dictionary<string, U6JXY4nDydSARSSHWXrW> dn0i12asK9;

	internal static sG6fxPineAdO5jRoY00 hDdEFilJfSq6Nt1jWETl;

	public sG6fxPineAdO5jRoY00(Dispatcher P_0)
	{
		iMXMXhlJGMgAoHTFjuY9();
		dn0i12asK9 = new Dictionary<string, U6JXY4nDydSARSSHWXrW>();
		base._002Ector();
		int num = 0;
		if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_11b8736b0585457b9538011988d6d2f9 == 0)
		{
			num = 0;
		}
		while (true)
		{
			switch (num)
			{
			case 1:
				XWeiNaoKc9 = new HashSet<string>();
				b8AkysfukSBAWXjMK6sm.IBcfuKIDIDv(QbKiY1X3Tn);
				return;
			}
			WVciiolrcX = P_0;
			num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_0aea3f4dc28f4bcb92a1f998dc5afbed == 0)
			{
				num = 1;
			}
		}
	}

	private void QbKiY1X3Tn(h3GPi790NINi0SKF01rq P_0)
	{
		J0blt9nDK5IECntROjxQ CS_0024_003C_003E8__locals7 = new J0blt9nDK5IECntROjxQ();
		CS_0024_003C_003E8__locals7.pblnDh1eWRt = P_0;
		CS_0024_003C_003E8__locals7.OASnDwwG6Rk = this;
		WVciiolrcX.InvokeAsync(delegate
		{
			if ((string)J0blt9nDK5IECntROjxQ.DOT2dVN2LdrIGDkNU5Yf(CS_0024_003C_003E8__locals7.pblnDh1eWRt.bky901AqCit()) == CS_0024_003C_003E8__locals7.OASnDwwG6Rk.fnwikttFHt)
			{
				CS_0024_003C_003E8__locals7.OASnDwwG6Rk.T6livHIWgB(CS_0024_003C_003E8__locals7.pblnDh1eWRt.bky901AqCit().Symbol, CS_0024_003C_003E8__locals7.pblnDh1eWRt.Data);
			}
		});
		int num = 0;
		if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_fa74d46e0c824e0b89c71deca0488611 == 0)
		{
			num = 0;
		}
		switch (num)
		{
		case 0:
			break;
		}
	}

	public void mrpioIELYU(List<Symbol> P_0, DateTime P_1)
	{
		FcMilj35PJ = true;
		skxib6fuDN = P_1;
		fnwikttFHt = Guid.NewGuid().ToString();
		dn0i12asK9.Clear();
		XWeiNaoKc9.Clear();
		foreach (Symbol item in P_0)
		{
			Symbol symbol = item.GetSymbol(P_1);
			if (!dn0i12asK9.ContainsKey(symbol.ID))
			{
				dn0i12asK9.Add(symbol.ID, new U6JXY4nDydSARSSHWXrW(symbol));
			}
			if (!XWeiNaoKc9.Contains(symbol.ID))
			{
				XWeiNaoKc9.Add(symbol.ID);
			}
			RequestData(symbol, P_1);
		}
	}

	private void RequestData(Symbol symbol, DateTime date)
	{
		if (symbol != null)
		{
			DataCycle dataCycle = new DataCycle
			{
				StartDate = date,
				EndDate = date
			};
			b8AkysfukSBAWXjMK6sm.BrHfuWeREBg(fnwikttFHt, stmj4Ul1bF7178khnjLy.BC1l1WXFcAt(0x16AD7E76 ^ 0x16AD6FCE), (string)wTRkCOlJYeOttkZ7tAwP(0x741B85CB ^ 0x741B9473), symbol, dataCycle, 1);
		}
	}

	public void T6livHIWgB(Symbol P_0, ICollection<byte[]> P_1)
	{
		if (dn0i12asK9.ContainsKey(P_0.ID))
		{
			U6JXY4nDydSARSSHWXrW u6JXY4nDydSARSSHWXrW = dn0i12asK9[P_0.ID];
			if (P_1.Count > 0)
			{
				u6JXY4nDydSARSSHWXrW.dCnnDCKhHk2 = P_1.First();
			}
			u6JXY4nDydSARSSHWXrW.nbsnDru4DCA = true;
		}
		if (dn0i12asK9.Values.Any((U6JXY4nDydSARSSHWXrW i) => !i.nbsnDru4DCA))
		{
			return;
		}
		if (FcMilj35PJ && dn0i12asK9.Values.All((U6JXY4nDydSARSSHWXrW i) => i.dCnnDCKhHk2 == null) && nFciDJUlEF < 10)
		{
			NMHiaPbl1Z(j7ti4594Z5);
			return;
		}
		try
		{
			nFciDJUlEF = 0;
			j18iDj9nukSCmEyZs5lH.Settings.RecordsDate = skxib6fuDN;
			List<Tuple<Symbol, byte[]>> list = new List<Tuple<Symbol, byte[]>>();
			foreach (U6JXY4nDydSARSSHWXrW value in dn0i12asK9.Values)
			{
				list.Add(new Tuple<Symbol, byte[]>(value.Symbol, value.dCnnDCKhHk2));
			}
			HistoryPlayerModule.Init(skxib6fuDN, list);
		}
		catch (Exception e)
		{
			LogManager.WriteError(e);
		}
	}

	public void a8EiBoZgao(List<MPdIMTi0styk2MD4qWM> P_0)
	{
		FcMilj35PJ = false;
		if (P_0 == null || P_0.Count == 0)
		{
			return;
		}
		try
		{
			skxib6fuDN = P_0[0].lk2iHiwjDf;
			XWeiNaoKc9 = new HashSet<string>(P_0.Select((MPdIMTi0styk2MD4qWM r) => r.Name));
			HistoryPlayerModule.Init(skxib6fuDN, P_0.Select((MPdIMTi0styk2MD4qWM r) => r.OMbi9LrenC).ToArray());
		}
		catch (Exception e)
		{
			LogManager.WriteError(e);
		}
	}

	public void NMHiaPbl1Z(int P_0)
	{
		j7ti4594Z5 = P_0;
		if (skxib6fuDN == DateTime.MinValue)
		{
			return;
		}
		int num = 2;
		DateTime dateTime2 = default(DateTime);
		int num5 = default(int);
		int num4 = default(int);
		string fileNameWithoutExtension = default(string);
		string item = default(string);
		string text2 = default(string);
		List<MPdIMTi0styk2MD4qWM> list = default(List<MPdIMTi0styk2MD4qWM>);
		string[] array = default(string[]);
		while (true)
		{
			switch (num)
			{
			case 2:
				if (XWeiNaoKc9 != null)
				{
					num = 3;
					continue;
				}
				return;
			case 4:
				return;
			case 3:
				if (XWeiNaoKc9.Count == 0)
				{
					int num2 = 4;
					num = num2;
					continue;
				}
				if (FcMilj35PJ)
				{
					num = 5;
					continue;
				}
				try
				{
					string text = ((MhMDPU9v8rkigy1ao0Th)vcnoy9lJi2MXdoIOqa10()).RecordsPath;
					int num3 = 8;
					while (true)
					{
						switch (num3)
						{
						case 1:
							return;
						case 5:
							skxib6fuDN = dateTime2;
							num3 = 1;
							if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_43d123ebfe574af38268397bb0ae2d1a != 0)
							{
								num3 = 11;
							}
							break;
						case 11:
							GTuBColJDKrGxN5o0Q57(j18iDj9nukSCmEyZs5lH.Settings, skxib6fuDN);
							num3 = 10;
							if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_aab13e7d663746898a6666b7303ea6c2 != 0)
							{
								num3 = 5;
							}
							break;
						case 2:
							if (num5 > 10)
							{
								return;
							}
							dateTime2 = skxib6fuDN.AddDays((P_0 > 0) ? num5 : (-num5));
							num3 = 3;
							break;
						default:
							num4++;
							goto IL_03c0;
						case 9:
							if (fileNameWithoutExtension != null)
							{
								item = fileNameWithoutExtension.Substring(0, fileNameWithoutExtension.Length - 11);
								num3 = 13;
								break;
							}
							goto default;
						case 13:
						{
							if (!XWeiNaoKc9.Contains(item))
							{
								goto default;
							}
							MPdIMTi0styk2MD4qWM item2 = new MPdIMTi0styk2MD4qWM
							{
								lk2iHiwjDf = dateTime2,
								Name = fileNameWithoutExtension.Substring(0, fileNameWithoutExtension.Length - 11),
								OMbi9LrenC = text2
							};
							list.Add(item2);
							num3 = 0;
							if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_0a80f370f27d471fab60f042c9fa7b49 == 0)
							{
								num3 = 0;
							}
							break;
						}
						case 8:
							if (Mmp9mklJlIEbEjIYM7ZA(text))
							{
								return;
							}
							goto case 12;
						case 12:
							if (!K8FGNIlJ4kwog0iZ5eSa(text))
							{
								return;
							}
							goto case 6;
						case 6:
							num5 = 1;
							num3 = 2;
							break;
						case 4:
							num5++;
							goto case 2;
						case 3:
						{
							string[] files = Directory.GetFiles(text, string.Format(stmj4Ul1bF7178khnjLy.BC1l1WXFcAt(0x446AB724 ^ 0x446A9C94), dateTime2), SearchOption.AllDirectories);
							if (files.Length == 0)
							{
								goto case 4;
							}
							list = new List<MPdIMTi0styk2MD4qWM>();
							array = files;
							num4 = 0;
							goto IL_03c0;
						}
						case 7:
							if (list.Count <= 0)
							{
								return;
							}
							num3 = 5;
							break;
						case 10:
							{
								P24pfTlJbkNI2GM5Fm4m(skxib6fuDN, list.Select((MPdIMTi0styk2MD4qWM r) => r.OMbi9LrenC).ToArray());
								num3 = 0;
								if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_ff2c70a81f2141b98b88fc10875a3726 == 0)
								{
									num3 = 1;
								}
								break;
							}
							IL_03c0:
							if (num4 < array.Length)
							{
								text2 = array[num4];
								fileNameWithoutExtension = Path.GetFileNameWithoutExtension(text2);
								num3 = 9;
								if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_fb3e1155cc384cc2a7c812423a76ea76 == 0)
								{
									num3 = 9;
								}
							}
							else
							{
								num3 = 7;
							}
							break;
						}
					}
				}
				catch (Exception e)
				{
					LogManager.WriteError(e);
					return;
				}
			case 1:
				return;
			case 5:
			{
				nFciDJUlEF++;
				DateTime dateTime = skxib6fuDN.AddDays((P_0 > 0) ? 1 : (-1));
				if (dateTime.Date > hKndaJlJoSbeTPBeBwJ4().Date)
				{
					num = 1;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_c1a63437a5bc4d139ae2c4a2f19ec947 != 0)
					{
						num = 0;
					}
					continue;
				}
				skxib6fuDN = dateTime;
				num = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_fc665aa6b49746ab985cf6653d959552 != 0)
				{
					num = 0;
				}
				continue;
			}
			}
			fnwikttFHt = Guid.NewGuid().ToString();
			uAGOgJlJvck0QxQ2snvl(dn0i12asK9);
			using HashSet<string>.Enumerator enumerator = XWeiNaoKc9.GetEnumerator();
			while (enumerator.MoveNext())
			{
				while (true)
				{
					Symbol symbol = (Symbol)Cb24SblJBaUdMbci6fO2(enumerator.Current);
					if (symbol != null)
					{
						dn0i12asK9.Add((string)wOQLc6lJawemykgD4pRd(symbol), new U6JXY4nDydSARSSHWXrW(symbol));
						RequestData(symbol, skxib6fuDN);
						int num6 = 0;
						if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_a849a254fa6841d5989e377890b7578f != 0)
						{
							num6 = 0;
						}
						switch (num6)
						{
						case 1:
							continue;
						}
					}
					break;
				}
			}
			return;
		}
	}

	static sG6fxPineAdO5jRoY00()
	{
		stmj4Ul1bF7178khnjLy.nWrl1glAtDi();
	}

	internal static void iMXMXhlJGMgAoHTFjuY9()
	{
		bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
	}

	internal static bool fDqDlYlJ90VW5rd0gcV1()
	{
		return hDdEFilJfSq6Nt1jWETl == null;
	}

	internal static sG6fxPineAdO5jRoY00 Hh5THLlJnuYWrkdQgQUw()
	{
		return hDdEFilJfSq6Nt1jWETl;
	}

	internal static object wTRkCOlJYeOttkZ7tAwP(int P_0)
	{
		return stmj4Ul1bF7178khnjLy.BC1l1WXFcAt(P_0);
	}

	internal static DateTime hKndaJlJoSbeTPBeBwJ4()
	{
		return TimeHelper.LocalTime;
	}

	internal static void uAGOgJlJvck0QxQ2snvl(object P_0)
	{
		((Dictionary<string, U6JXY4nDydSARSSHWXrW>)P_0).Clear();
	}

	internal static object Cb24SblJBaUdMbci6fO2(object P_0)
	{
		return SymbolManager.Get((string)P_0);
	}

	internal static object wOQLc6lJawemykgD4pRd(object P_0)
	{
		return ((Symbol)P_0).ID;
	}

	internal static object vcnoy9lJi2MXdoIOqa10()
	{
		return j18iDj9nukSCmEyZs5lH.Settings;
	}

	internal static bool Mmp9mklJlIEbEjIYM7ZA(object P_0)
	{
		return string.IsNullOrEmpty((string)P_0);
	}

	internal static bool K8FGNIlJ4kwog0iZ5eSa(object P_0)
	{
		return Directory.Exists((string)P_0);
	}

	internal static void GTuBColJDKrGxN5o0Q57(object P_0, DateTime P_1)
	{
		((MhMDPU9v8rkigy1ao0Th)P_0).RecordsDate = P_1;
	}

	internal static void P24pfTlJbkNI2GM5Fm4m(DateTime P_0, object P_1)
	{
		HistoryPlayerModule.Init(P_0, (string[])P_1);
	}
}
