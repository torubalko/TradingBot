using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Runtime.CompilerServices;
using System.Threading;
using aEpmU09nz6MEoNmc0pGJ;
using aeXChk9vAhkf7Zm8SpOk;
using CA00IGfn6UyfKXYOM3Is;
using ECOEgqlSad8NUJZ2Dr9n;
using TigerTrade.Annotations;
using TigerTrade.Config.Common;
using TigerTrade.Core.Utils.Logging;
using TigerTrade.Core.Utils.Time;
using TigerTrade.Tc.Data;
using TigerTrade.Tc.Manager;
using TuAMtrl1Nd3XoZQQUXf0;

namespace WXLIGtHMoPEMeZSdsAvj;

internal class yDS857HMYC73oi0jMXAy : INotifyPropertyChanged, IDisposable
{
	[CompilerGenerated]
	private PropertyChangedEventHandler m_PropertyChanged;

	private static yDS857HMYC73oi0jMXAy XMHHMk0AFHb;

	private bool OQxHM1nb3DD;

	private object wPpHM5CRIac;

	private double lT1HMSoWdtu;

	internal static yDS857HMYC73oi0jMXAy OxNJ17D62Mpfx1HqDXDG;

	public static yDS857HMYC73oi0jMXAy Instance
	{
		get
		{
			if (XMHHMk0AFHb == null || XMHHMk0AFHb.OQxHM1nb3DD)
			{
				XMHHMk0AFHb = new yDS857HMYC73oi0jMXAy();
				int num = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_11b8736b0585457b9538011988d6d2f9 != 0)
				{
					num = 0;
				}
				switch (num)
				{
				}
			}
			return XMHHMk0AFHb;
		}
	}

	public double NetPnl
	{
		get
		{
			if (!OQxHM1nb3DD)
			{
				return lT1HMSoWdtu;
			}
			return 0.0;
		}
		set
		{
			if (!OQxHM1nb3DD && !(Math.Abs(lT1HMSoWdtu - num) < double.Epsilon))
			{
				lT1HMSoWdtu = num;
				int num2 = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_f40a817752724303a7406a720886b183 != 0)
				{
					num2 = 0;
				}
				switch (num2)
				{
				}
				uKlHM4ytkNE(stmj4Ul1bF7178khnjLy.BC1l1WXFcAt(-2002318893 ^ -2002280647));
			}
		}
	}

	public event PropertyChangedEventHandler PropertyChanged
	{
		[CompilerGenerated]
		add
		{
			int num = 2;
			int num2 = num;
			PropertyChangedEventHandler propertyChangedEventHandler = default(PropertyChangedEventHandler);
			while (true)
			{
				switch (num2)
				{
				default:
					return;
				case 2:
					propertyChangedEventHandler = this.m_PropertyChanged;
					num2 = 1;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_1b729872d4424497a28393432ab4c541 == 0)
					{
						num2 = 0;
					}
					continue;
				case 0:
					return;
				case 1:
					break;
				}
				PropertyChangedEventHandler propertyChangedEventHandler2;
				do
				{
					propertyChangedEventHandler2 = propertyChangedEventHandler;
					PropertyChangedEventHandler value2 = (PropertyChangedEventHandler)Delegate.Combine(propertyChangedEventHandler2, b);
					propertyChangedEventHandler = Interlocked.CompareExchange(ref this.m_PropertyChanged, value2, propertyChangedEventHandler2);
				}
				while ((object)propertyChangedEventHandler != propertyChangedEventHandler2);
				num2 = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_8b8f48487ce54157a86b0385feea16a6 == 0)
				{
					num2 = 0;
				}
			}
		}
		[CompilerGenerated]
		remove
		{
			PropertyChangedEventHandler propertyChangedEventHandler = this.m_PropertyChanged;
			PropertyChangedEventHandler propertyChangedEventHandler2;
			PropertyChangedEventHandler value2 = default(PropertyChangedEventHandler);
			do
			{
				propertyChangedEventHandler2 = propertyChangedEventHandler;
				int num = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_fb3e1155cc384cc2a7c812423a76ea76 == 0)
				{
					num = 0;
				}
				while (true)
				{
					switch (num)
					{
					default:
						value2 = (PropertyChangedEventHandler)lu21mdD69Bb7YuQutUrP(propertyChangedEventHandler2, propertyChangedEventHandler3);
						num = 0;
						if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_fb3e1155cc384cc2a7c812423a76ea76 != 0)
						{
							num = 1;
						}
						continue;
					case 1:
						break;
					}
					break;
				}
				propertyChangedEventHandler = Interlocked.CompareExchange(ref this.m_PropertyChanged, value2, propertyChangedEventHandler2);
			}
			while ((object)propertyChangedEventHandler != propertyChangedEventHandler2);
		}
	}

	public void TerHMvQgw0y()
	{
		if (OQxHM1nb3DD)
		{
			return;
		}
		h8uiRtfnRZ9JJpkepmSl.hJqfnZk3aqO(m6DHMamqRCM);
		object obj = wPpHM5CRIac;
		int num = 0;
		if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_8b6bac13ae314900826ed96af7afc27b != 0)
		{
			num = 0;
		}
		while (true)
		{
			switch (num)
			{
			case 1:
				return;
			}
			bool lockTaken = false;
			try
			{
				Monitor.Enter(obj, ref lockTaken);
				int num2 = 1;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_ba87d68105604f98a891a0549ef4b7f9 == 0)
				{
					num2 = 1;
				}
				while (true)
				{
					switch (num2)
					{
					case 1:
						j18iDj9nukSCmEyZs5lH.Settings.PnlWidgetCurrentStartDate = DateTime.Today;
						KkbZm8D6Gl3g563BUBqI(j18iDj9nukSCmEyZs5lH.Settings, CiT2yhD6nNxsrve6Eube() - DateTime.Today);
						NetPnl = 0.0;
						WpMHMi2DLIx();
						num2 = 0;
						if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_6938a97537c94834bed9381eb4051eec == 0)
						{
							num2 = 0;
						}
						continue;
					case 0:
						break;
					}
					break;
				}
			}
			finally
			{
				if (lockTaken)
				{
					Monitor.Exit(obj);
				}
			}
			h8uiRtfnRZ9JJpkepmSl.sVufny5rRK1(m6DHMamqRCM);
			num = 1;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_d3afdd6ad27a4c3b87071f1be51e7ef3 == 0)
			{
				num = 0;
			}
		}
	}

	public yDS857HMYC73oi0jMXAy()
	{
		bjBp4DlSBZNrmYFiJ2P5.uAtNhrIAcgj();
		wPpHM5CRIac = new object();
		base._002Ector();
		int num = 0;
		if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_de1b6b238ba046ff8910d780c42f0e95 == 0)
		{
			num = 0;
		}
		while (true)
		{
			switch (num)
			{
			case 1:
				j18iDj9nukSCmEyZs5lH.Settings.PropertyChanged += VXjHMBmObCk;
				return;
			}
			WpMHMi2DLIx();
			h8uiRtfnRZ9JJpkepmSl.sVufny5rRK1(m6DHMamqRCM);
			num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_d9af442440454effa9efd8da8e33ec96 != 0)
			{
				num = 1;
			}
		}
	}

	private void VXjHMBmObCk(object P_0, PropertyChangedEventArgs P_1)
	{
		int num = 1;
		int num2 = num;
		while (true)
		{
			object obj;
			switch (num2)
			{
			default:
				obj = null;
				break;
			case 1:
				if (P_1 == null)
				{
					num2 = 0;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_c1a63437a5bc4d139ae2c4a2f19ec947 == 0)
					{
						num2 = 0;
					}
					continue;
				}
				obj = xbP5FSD6Y68eOlYhdlaw(P_1);
				break;
			case 2:
				NetPnl = 0.0;
				WpMHMi2DLIx();
				return;
			}
			if (!BhOl5YD6obru9WfA9yg6(obj, stmj4Ul1bF7178khnjLy.BC1l1WXFcAt(0x34407BB ^ 0x34415DF)))
			{
				break;
			}
			num2 = 2;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_11b8736b0585457b9538011988d6d2f9 != 0)
			{
				num2 = 2;
			}
		}
	}

	private void m6DHMamqRCM(UserDeal P_0)
	{
		if (OQxHM1nb3DD)
		{
			return;
		}
		if (P_0 == null)
		{
			int num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_ad0a44f3eae14332b41c0c5ef48d2cbb == 0)
			{
				num = 0;
			}
			switch (num)
			{
			case 0:
				break;
			case 1:
				break;
			}
			return;
		}
		object obj = wPpHM5CRIac;
		bool lockTaken = false;
		try
		{
			Monitor.Enter(obj, ref lockTaken);
			NetPnl += skiLM4D6vyRs3ENWWdni(P_0) - P_0.Comission;
		}
		finally
		{
			if (lockTaken)
			{
				zllPgID6BflLa9qK2QQb(obj);
			}
		}
	}

	private void WpMHMi2DLIx()
	{
		int num = 1;
		int num2 = num;
		UserDeal current = default(UserDeal);
		while (true)
		{
			switch (num2)
			{
			default:
				return;
			case 0:
				return;
			case 1:
				if (!OQxHM1nb3DD)
				{
					try
					{
						_ = j18iDj9nukSCmEyZs5lH.Settings.TradeMode;
						List<UserDeal> list = h8uiRtfnRZ9JJpkepmSl.QY1fnI1yKes();
						if (list == null)
						{
							return;
						}
						List<UserDeal>.Enumerator enumerator = list.GetEnumerator();
						int num3 = 0;
						if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_03c20a54a7dc45f8a5130d4984fa4aea == 0)
						{
							num3 = 0;
						}
						switch (num3)
						{
						case 1:
							return;
						}
						try
						{
							while (true)
							{
								if (!enumerator.MoveNext())
								{
									int num4 = 0;
									if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_976d29d6825c4c4995e3a2719d735c00 != 0)
									{
										num4 = 0;
									}
									switch (num4)
									{
									default:
										return;
									case 0:
										return;
									case 1:
										break;
									}
								}
								else
								{
									current = enumerator.Current;
									if (!QTyHMlDC4ba(current))
									{
										continue;
									}
								}
								NetPnl += current.Profit - QNohVJD6aDwYPFWwKkBt(current);
							}
						}
						finally
						{
							((IDisposable)enumerator/*cast due to .constrained prefix*/).Dispose();
						}
					}
					catch (Exception e)
					{
						LogManager.WriteError(e);
						return;
					}
				}
				num2 = 0;
				if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_859c6249cb0f4f11b2da29d1228ce418 != 0)
				{
					num2 = 0;
				}
				break;
			}
		}
	}

	private bool QTyHMlDC4ba(UserDeal P_0)
	{
		Symbol symbol = SymbolManager.Get(P_0?.SymbolID);
		int num;
		DateTime dateTime = default(DateTime);
		DateTime? dateTime2 = default(DateTime?);
		if (symbol == null)
		{
			num = 9;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_6d365c300683408da8d70007bc278f93 == 0)
			{
				num = 5;
			}
		}
		else
		{
			dateTime = va0lqVD6lMLmSiPOi1KJ(Q0nnX7D6iBqKMl13fwxY(P_0), symbol.Exchange, true);
			dateTime2 = ((MhMDPU9v8rkigy1ao0Th)JY6MjUD64mH1Q1yk4MP1()).PnlWidgetCurrentStartDate;
			if (!dateTime2.HasValue)
			{
				goto IL_01ce;
			}
			num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_3023bd6c0f7846878513499bf5c36161 != 0)
			{
				num = 0;
			}
		}
		goto IL_0009;
		IL_0224:
		AppTradeMode appTradeMode = AppTradeMode.Player;
		num = 5;
		if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_4aa3a79213674c27a6bc763076b8caed != 0)
		{
			num = 5;
		}
		goto IL_0009;
		IL_01ce:
		appTradeMode = AppTradeMode.Live;
		if (!g9KM8MD6Nv5Yf7TTe0uE(P_0))
		{
			num = 4;
			goto IL_0009;
		}
		goto IL_0224;
		IL_0009:
		while (true)
		{
			int num2;
			switch (num)
			{
			default:
				dateTime2 = j18iDj9nukSCmEyZs5lH.Settings.PnlWidgetCurrentStartDate;
				if (!PeSsgGD6D8s4cXkHsiTY(dateTime2.Value.Date, dateTime.Date))
				{
					num = 5;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_d4badf00eaf04a4c91e3397f36a429cf != 0)
					{
						num = 6;
					}
					continue;
				}
				goto case 1;
			case 3:
				break;
			case 1:
				return false;
			case 6:
				dateTime2 = j18iDj9nukSCmEyZs5lH.Settings.PnlWidgetCurrentStartDate;
				num2 = 3;
				goto IL_0005;
			case 4:
			case 5:
				if (GNj714D6k6QnJIJolLks(P_0))
				{
					appTradeMode = AppTradeMode.Simulator;
					num = 2;
					continue;
				}
				goto case 2;
			case 2:
				if (appTradeMode != GeEUkoD61YwHN9u3ZvkK(j18iDj9nukSCmEyZs5lH.Settings))
				{
					num2 = 7;
					goto IL_0005;
				}
				return true;
			case 7:
				return false;
			case 9:
				return false;
			case 8:
				goto IL_0224;
				IL_0005:
				num = num2;
				continue;
			}
			break;
		}
		if (Be6aJGD6bU1ijmQfxoKR(dateTime2.Value.Date, dateTime.Date) && PeSsgGD6D8s4cXkHsiTY(dateTime.Date.Add(j18iDj9nukSCmEyZs5lH.Settings.PnlWidgetCurrentStartTime), dateTime))
		{
			return false;
		}
		goto IL_01ce;
	}

	[NotifyPropertyChangedInvocator]
	public void uKlHM4ytkNE([CallerMemberName] string propertyName = null)
	{
		int num = 1;
		int num2 = num;
		while (true)
		{
			switch (num2)
			{
			default:
				return;
			case 1:
				if (OQxHM1nb3DD)
				{
					num2 = 0;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_08ac0ac701064383a00c80bff8cd4e3f != 0)
					{
						num2 = 0;
					}
					break;
				}
				this.PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
				return;
			case 0:
				return;
			}
		}
	}

	public void Dispose()
	{
		Dispose(_0020: true);
		GC.SuppressFinalize(this);
	}

	protected virtual void Dispose(bool P_0)
	{
		if (OQxHM1nb3DD)
		{
			return;
		}
		if (P_0)
		{
			int num = 0;
			if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_3a7b10748dce4fec98054526a92d6ccf == 0)
			{
				num = 0;
			}
			while (true)
			{
				switch (num)
				{
				case 1:
					break;
				default:
					fsfMO2D65uvooWjF3UE5(j18iDj9nukSCmEyZs5lH.Settings, new PropertyChangedEventHandler(VXjHMBmObCk));
					num = 1;
					if (_003CModule_003E_007Bce1afb0d_002D8724_002D4a3c_002D8977_002Dc81e93990fb1_007D.m_f6b8a9ae320a40f994b0db08d42c2a95 != 0)
					{
						num = 1;
					}
					continue;
				}
				break;
			}
			h8uiRtfnRZ9JJpkepmSl.hJqfnZk3aqO(m6DHMamqRCM);
		}
		OQxHM1nb3DD = true;
	}

	~yDS857HMYC73oi0jMXAy()
	{
		try
		{
			hDePjvD6S2AuqlPRXheV(this, false);
		}
		finally
		{
			Qocls5D6xHGSst6AMh7n(this);
		}
	}

	static yDS857HMYC73oi0jMXAy()
	{
		stmj4Ul1bF7178khnjLy.nWrl1glAtDi();
	}

	internal static bool C0VKoGD6H7l9W8B5U4n5()
	{
		return OxNJ17D62Mpfx1HqDXDG == null;
	}

	internal static yDS857HMYC73oi0jMXAy YCKq0UD6fFCBxqpW1MJ8()
	{
		return OxNJ17D62Mpfx1HqDXDG;
	}

	internal static object lu21mdD69Bb7YuQutUrP(object P_0, object P_1)
	{
		return Delegate.Remove((Delegate)P_0, (Delegate)P_1);
	}

	internal static DateTime CiT2yhD6nNxsrve6Eube()
	{
		return DateTime.Now;
	}

	internal static void KkbZm8D6Gl3g563BUBqI(object P_0, TimeSpan P_1)
	{
		((MhMDPU9v8rkigy1ao0Th)P_0).PnlWidgetCurrentStartTime = P_1;
	}

	internal static object xbP5FSD6Y68eOlYhdlaw(object P_0)
	{
		return ((PropertyChangedEventArgs)P_0).PropertyName;
	}

	internal static bool BhOl5YD6obru9WfA9yg6(object P_0, object P_1)
	{
		return (string)P_0 == (string)P_1;
	}

	internal static double skiLM4D6vyRs3ENWWdni(object P_0)
	{
		return ((UserDeal)P_0).Profit;
	}

	internal static void zllPgID6BflLa9qK2QQb(object P_0)
	{
		Monitor.Exit(P_0);
	}

	internal static double QNohVJD6aDwYPFWwKkBt(object P_0)
	{
		return ((UserDeal)P_0).Comission;
	}

	internal static DateTime Q0nnX7D6iBqKMl13fwxY(object P_0)
	{
		return ((UserDeal)P_0).OpenTime;
	}

	internal static DateTime va0lqVD6lMLmSiPOi1KJ(DateTime P_0, object P_1, bool P_2)
	{
		return TimeHelper.ConvertTimeToLocal(P_0, (string)P_1, P_2);
	}

	internal static object JY6MjUD64mH1Q1yk4MP1()
	{
		return j18iDj9nukSCmEyZs5lH.Settings;
	}

	internal static bool PeSsgGD6D8s4cXkHsiTY(DateTime P_0, DateTime P_1)
	{
		return P_0 > P_1;
	}

	internal static bool Be6aJGD6bU1ijmQfxoKR(DateTime P_0, DateTime P_1)
	{
		return P_0 == P_1;
	}

	internal static bool g9KM8MD6Nv5Yf7TTe0uE(object P_0)
	{
		return ((UserDeal)P_0).IsPlayer;
	}

	internal static bool GNj714D6k6QnJIJolLks(object P_0)
	{
		return ((UserDeal)P_0).IsSimulator;
	}

	internal static AppTradeMode GeEUkoD61YwHN9u3ZvkK(object P_0)
	{
		return ((MhMDPU9v8rkigy1ao0Th)P_0).TradeMode;
	}

	internal static void fsfMO2D65uvooWjF3UE5(object P_0, object P_1)
	{
		((MhMDPU9v8rkigy1ao0Th)P_0).PropertyChanged -= (PropertyChangedEventHandler)P_1;
	}

	internal static void hDePjvD6S2AuqlPRXheV(object P_0, bool P_1)
	{
		((yDS857HMYC73oi0jMXAy)P_0).Dispose(P_1);
	}

	internal static void Qocls5D6xHGSst6AMh7n(object P_0)
	{
		P_0.Finalize();
	}
}
