<?xml version="1.0" encoding="utf-8"?>
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:controls="clr-namespace:ActiproSoftware.Windows.Controls" xmlns:controlsPrimitives="clr-namespace:ActiproSoftware.Windows.Controls.Primitives" xmlns:data="clr-namespace:ActiproSoftware.Windows.Data" xmlns:themes="clr-namespace:ActiproSoftware.Windows.Themes">
  <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
  <data:CornerRadiusConverter x:Key="CornerRadiusConverter" />
  <MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter" />
  <data:ThicknessConverter x:Key="ThicknessConverter" />
  <Style x:Key="{x:Static themes:SharedResourceKeys.MenuEmbeddedSeparatorStyleKey}" TargetType="{x:Type Separator}">
    <Setter Property="Background" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuSeparatorBackgroundNormalBrushKey}}" />
    <Setter Property="Margin" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuSeparatorMarginNormalThicknessKey}}" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Separator}">
          <Rectangle Height="1" Fill="{TemplateBinding Control.Background}" SnapsToDevicePixels="True" />
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="MenuScrollButton" TargetType="{x:Type RepeatButton}">
    <Setter Property="Background" Value="#00FFFFFF" />
    <Setter Property="BorderBrush" Value="#00FFFFFF" />
    <Setter Property="BorderThickness" Value="1" />
    <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" />
    <Setter Property="ButtonBase.ClickMode" Value="Hover" />
    <Setter Property="MinWidth" Value="0" />
    <Setter Property="MinHeight" Value="0" />
    <Setter Property="Padding" Value="3" />
    <Setter Property="themes:ThemeProperties.CornerRadius" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderNormalCornerRadiusKey}}" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border BorderBrush="{TemplateBinding Control.BorderBrush}" BorderThickness="{TemplateBinding Control.BorderThickness}" Background="{TemplateBinding Control.Background}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="true">
            <Border Name="innerBorder" BorderBrush="#00FFFFFF" BorderThickness="{TemplateBinding Control.BorderThickness}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="true">
              <ContentPresenter Margin="{TemplateBinding Control.Padding}" VerticalAlignment="Center" HorizontalAlignment="Center" />
            </Border>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsPressed" Value="true">
              <Setter Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBackgroundHighlightedBrushKey}}" Property="Background" />
              <Setter Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderHighlightedBrushKey}}" Property="BorderBrush" />
              <Setter TargetName="innerBorder" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderHighlightedBrushKey}}" Property="Border.BorderBrush" />
              <Setter Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundHighlightedBrushKey}}" Property="Foreground" />
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{x:Static themes:SharedResourceKeys.MenuEmbeddedScrollViewerStyleKey}" TargetType="{x:Type ScrollViewer}">
    <Setter Property="HorizontalScrollBarVisibility" Value="Hidden" />
    <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ScrollViewer}">
          <Grid SnapsToDevicePixels="True">
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto" />
              <RowDefinition Height="*" />
              <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <controls:PixelSnapper Grid.Row="1">
              <ScrollContentPresenter Name="PART_ScrollContentPresenter" Margin="{TemplateBinding Control.Padding}" CanContentScroll="{TemplateBinding ScrollViewer.CanContentScroll}" />
            </controls:PixelSnapper>
            <RepeatButton Margin="0,0,0,1" Command="{x:Static ScrollBar.LineUpCommand}" Focusable="False" Style="{StaticResource MenuScrollButton}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}">
              <UIElement.Visibility>
                <MultiBinding FallbackValue="Visibility.Collapsed" ConverterParameter="0" Converter="{StaticResource MenuScrollingVisibilityConverter}">
                  <Binding Path="ComputedVerticalScrollBarVisibility" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}" />
                </MultiBinding>
              </UIElement.Visibility>
              <ContentPresenter ContentTemplate="{DynamicResource {x:Static themes:SharedResourceKeys.LargeUpArrowGlyphTemplateKey}}" />
            </RepeatButton>
            <RepeatButton Margin="0,1,0,0" Grid.Row="2" Command="{x:Static ScrollBar.LineDownCommand}" Focusable="False" Style="{StaticResource MenuScrollButton}" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}">
              <UIElement.Visibility>
                <MultiBinding FallbackValue="Visibility.Collapsed" ConverterParameter="100" Converter="{StaticResource MenuScrollingVisibilityConverter}">
                  <Binding Path="ComputedVerticalScrollBarVisibility" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}" />
                </MultiBinding>
              </UIElement.Visibility>
              <ContentPresenter ContentTemplate="{DynamicResource {x:Static themes:SharedResourceKeys.LargeDownArrowGlyphTemplateKey}}" />
            </RepeatButton>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <ControlTemplate x:Key="{x:Static themes:SharedResourceKeys.MenuItemSubmenuContentTemplateKey}" TargetType="{x:Type ContentControl}">
    <Grid Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBackgroundNormalBrushKey}}">
      <Border BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnBorderNormalBrushKey}}" BorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnBorderNormalThicknessKey}}" HorizontalAlignment="Left">
        <Rectangle Width="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnWidthDoubleKey}}" Fill="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnBackgroundNormalBrushKey}}" />
      </Border>
      <ContentPresenter />
    </Grid>
  </ControlTemplate>
  <ControlTemplate x:Key="{x:Static themes:SharedResourceKeys.MenuItemTopLevelItemTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid Name="rootGrid" SnapsToDevicePixels="True">
      <controlsPrimitives:ElementChrome x:Name="chrome" Background="{TemplateBinding Control.Background}" BackgroundHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBackgroundHoverBrushKey}}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBorderHoverBrushKey}}" BorderThickness="{TemplateBinding Control.BorderThickness}" InnerBorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonInnerBorderNormalBrushKey}}" InnerBorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonInnerBorderHoverBrushKey}}" InnerBorderThickness="{TemplateBinding Control.BorderThickness}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="True" />
      <Grid Margin="{TemplateBinding Control.Padding}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <ContentPresenter Name="icon" Margin="0,0,7,0" MaxWidth="16" MaxHeight="16" ContentSource="Icon" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
        <controls:PixelSnapper Grid.Column="1" VerticalRoundMode="CeilingToEven">
          <ContentPresenter ContentSource="Header" RecognizesAccessKey="True" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
        </controls:PixelSnapper>
      </Grid>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="controls:TitleBarMenu.IsInTitleBar" Value="True">
        <Setter TargetName="chrome" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonBackgroundActiveHoverBrushKey}}" Property="controlsPrimitives:ElementChrome.BackgroundHover" />
        <Setter TargetName="chrome" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonBorderActiveHoverBrushKey}}" Property="controlsPrimitives:ElementChrome.BorderBrushHover" />
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.InnerBorderBrush" Value="#00FFFFFF" />
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.InnerBorderBrushHover" Value="#00FFFFFF" />
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="MenuItem.IsHighlighted" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonForegroundHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="MenuItem.IsHighlighted" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="UIElement.IsKeyboardFocused" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonForegroundHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="UIElement.IsKeyboardFocused" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="UIElement.IsEnabled" Value="False" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="UIElement.IsEnabled" Value="False" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </MultiTrigger>
      <Trigger Property="MenuItem.Icon" Value="{x:Null}">
        <Setter TargetName="icon" Property="UIElement.Visibility" Value="Collapsed" />
      </Trigger>
      <Trigger Property="MenuItem.IsChecked" Value="True">
        <Setter TargetName="icon" Property="UIElement.Visibility" Value="Visible" />
        <Setter TargetName="icon" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuCheckGlyphTemplateKey}}" Property="ContentPresenter.ContentTemplate" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="1.0" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="{x:Static themes:SharedResourceKeys.MenuItemTopLevelHeaderTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid Name="rootGrid" SnapsToDevicePixels="True">
      <controlsPrimitives:ShadowChrome x:Name="headerShadow" Direction="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowDirectionDoubleKey}}" ShadowOpacity="{DynamicResource {x:Static themes:AssetResourceKeys.ShadowOpacityNormalDoubleKey}}" SnapsToDevicePixels="True">
        <controlsPrimitives:ElementChrome x:Name="chrome" Background="{TemplateBinding Control.Background}" BackgroundFocused="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupAnchorBackgroundOpenedBrushKey}}" BackgroundHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBackgroundHoverBrushKey}}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderBrushFocused="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalBrushKey}}" BorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBorderHoverBrushKey}}" BorderThickness="{TemplateBinding Control.BorderThickness}" InnerBorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonInnerBorderNormalBrushKey}}" InnerBorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonInnerBorderHoverBrushKey}}" InnerBorderThickness="{TemplateBinding Control.BorderThickness}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="True" />
      </controlsPrimitives:ShadowChrome>
      <Grid Margin="{TemplateBinding Control.Padding}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <ContentPresenter Name="icon" Margin="0,0,7,0" MaxWidth="16" MaxHeight="16" ContentSource="Icon" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
        <controls:PixelSnapper Grid.Column="1" VerticalRoundMode="CeilingToEven">
          <ContentPresenter ContentSource="Header" RecognizesAccessKey="True" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
        </controls:PixelSnapper>
      </Grid>
      <Popup Name="PART_Popup" AllowsTransparency="True" Placement="Bottom" VerticalOffset="-1" Focusable="False" PopupAnimation="None" themes:ThemeProperties.CornerRadius="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalCornerRadiusKey}}" IsOpen="{Binding Path=IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}">
        <controlsPrimitives:ShadowChrome x:Name="shadow" Direction="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowDirectionDoubleKey}}" ShadowOpacity="{DynamicResource {x:Static themes:AssetResourceKeys.ShadowOpacityNormalDoubleKey}}" SnapsToDevicePixels="True">
          <Grid ClipToBounds="True">
            <Border Name="menuPopupOuterBorder" Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBackgroundNormalBrushKey}}" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalBrushKey}}" BorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.PopupBorderNormalThicknessKey}}" SnapsToDevicePixels="True" CornerRadius="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius), ConverterParameter=TopRight,BottomRight,BottomLeft, Converter={StaticResource CornerRadiusConverter}}">
              <Grid>
                <Border Name="menuPopupInnerBorder" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupInnerBorderNormalBrushKey}}" BorderThickness="1" CornerRadius="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius), ConverterParameter=TopRight,BottomRight,BottomLeft, Converter={StaticResource CornerRadiusConverter}}" />
                <ScrollViewer Margin="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupPaddingNormalThicknessKey}}" CanContentScroll="True" Style="{DynamicResource {x:Static themes:SharedResourceKeys.MenuEmbeddedScrollViewerStyleKey}}">
                  <ContentControl Template="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemSubmenuContentTemplateKey}}" IsTabStop="False" RenderOptions.ClearTypeHint="Enabled">
                    <ItemsPresenter Name="ItemsPresenter" KeyboardNavigation.TabNavigation="Cycle" KeyboardNavigation.DirectionalNavigation="Cycle" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" Grid.IsSharedSizeScope="true" />
                  </ContentControl>
                </ScrollViewer>
              </Grid>
            </Border>
            <Border Name="transitionLine" Height="1" BorderThickness="1,0,1,0" BorderBrush="#00FFFFFF" Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupAnchorBackgroundOpenedBrushKey}}" HorizontalAlignment="Left" VerticalAlignment="Top" />
          </Grid>
        </controlsPrimitives:ShadowChrome>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="controls:TitleBarMenu.IsInTitleBar" Value="True">
        <Setter TargetName="chrome" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonBackgroundActiveHoverBrushKey}}" Property="controlsPrimitives:ElementChrome.BackgroundHover" />
        <Setter TargetName="chrome" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonBorderActiveHoverBrushKey}}" Property="controlsPrimitives:ElementChrome.BorderBrushHover" />
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.InnerBorderBrush" Value="#00FFFFFF" />
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.InnerBorderBrushHover" Value="#00FFFFFF" />
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="MenuItem.IsHighlighted" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonForegroundHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="MenuItem.IsHighlighted" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="UIElement.IsKeyboardFocused" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonForegroundHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="UIElement.IsKeyboardFocused" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveHoverBrushKey}}" Property="TextElement.Foreground" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="False" />
          <Condition Property="UIElement.IsEnabled" Value="False" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="controls:TitleBarMenu.IsInTitleBar" Value="True" />
          <Condition Property="UIElement.IsEnabled" Value="False" />
        </MultiTrigger.Conditions>
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.WindowTitleBarButtonForegroundActiveDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </MultiTrigger>
      <Trigger Property="MenuItem.Icon" Value="{x:Null}">
        <Setter TargetName="icon" Property="UIElement.Visibility" Value="Collapsed" />
      </Trigger>
      <Trigger Property="MenuItem.IsChecked" Value="True">
        <Setter TargetName="icon" Property="UIElement.Visibility" Value="Visible" />
        <Setter TargetName="icon" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuCheckGlyphTemplateKey}}" Property="ContentPresenter.ContentTemplate" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="1.0" />
      </Trigger>
      <Trigger Property="MenuItem.IsSuspendingPopupAnimation" Value="True">
        <Setter TargetName="PART_Popup" Property="Popup.PopupAnimation" Value="None" />
      </Trigger>
      <Trigger SourceName="PART_Popup" Property="Popup.HasDropShadow" Value="True">
        <Setter TargetName="shadow" Value="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowElevationInt32Key}}" Property="controlsPrimitives:ShadowChrome.Elevation" />
        <Setter TargetName="shadow" Property="FrameworkElement.Margin" Value="{Binding ElementName=shadow, Path=ShadowThickness, ConverterParameter=Left,Right,Bottom, Converter={StaticResource ThicknessConverter}}" />
      </Trigger>
      <DataTrigger Value="True" Binding="{Binding Source={x:Static SystemParameters.MenuDropAlignment}}">
        <Setter TargetName="transitionLine" Property="FrameworkElement.HorizontalAlignment" Value="Right" />
        <Setter TargetName="menuPopupOuterBorder" Property="Border.CornerRadius" Value="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius), ConverterParameter=TopLeft,BottomRight,BottomLeft, Converter={StaticResource CornerRadiusConverter}}" />
        <Setter TargetName="menuPopupInnerBorder" Property="Border.CornerRadius" Value="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius), ConverterParameter=TopLeft,BottomRight,BottomLeft, Converter={StaticResource CornerRadiusConverter}}" />
      </DataTrigger>
      <Trigger Property="MenuItem.IsSubmenuOpen" Value="True">
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Focused" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="transitionLine" Property="FrameworkElement.Width" Value="{Binding ElementName=chrome, Path=ActualWidth}" />
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="PART_Popup" Property="Popup.HasDropShadow" Value="True" />
          <Condition Property="MenuItem.IsSubmenuOpen" Value="True" />
        </MultiTrigger.Conditions>
        <Setter TargetName="headerShadow" Value="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowElevationInt32Key}}" Property="controlsPrimitives:ShadowChrome.Elevation" />
      </MultiTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="{x:Static themes:SharedResourceKeys.MenuItemSubmenuItemTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid Name="rootGrid" SnapsToDevicePixels="True">
      <Grid.ColumnDefinitions>
        <ColumnDefinition MinWidth="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnWidthDoubleKey}}" Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Name="spacerColumnDef" MinWidth="35" SharedSizeGroup="MenuItemSpacerColumnGroup" />
        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
        <ColumnDefinition MinWidth="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemPopupColumnWidthDoubleKey}}" Width="Auto" SharedSizeGroup="MenuItemPopupArrowColumnGroup" />
      </Grid.ColumnDefinitions>
      <controlsPrimitives:ElementChrome x:Name="chrome" Grid.ColumnSpan="5" Background="{TemplateBinding Control.Background}" BackgroundHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBackgroundHighlightedBrushKey}}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderHighlightedBrushKey}}" BorderThickness="{TemplateBinding Control.BorderThickness}" InnerBorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderNormalBrushKey}}" InnerBorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderHighlightedBrushKey}}" InnerBorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderNormalThicknessKey}}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="True" />
      <Border Name="checkPanel" Margin="2" Width="20" Height="20" Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBackgroundNormalBrushKey}}" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalBrushKey}}" BorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalThicknessKey}}" CornerRadius="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalCornerRadiusKey}}" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="True" Visibility="{Binding Path=IsChecked, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" />
      <ContentPresenter Name="icon" Margin="2" MaxWidth="16" MaxHeight="16" ContentSource="Icon" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
      <controls:PixelSnapper Grid.Column="1" VerticalRoundMode="CeilingToEven">
        <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Control.Padding}" RecognizesAccessKey="True" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
      </controls:PixelSnapper>
      <controls:PixelSnapper Grid.Column="3" VerticalRoundMode="CeilingToEven">
        <TextBlock Name="inputGestureTextBlock" Text="{TemplateBinding MenuItem.InputGestureText}" Foreground="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemDescriptionForegroundNormalBrushKey}}" VerticalAlignment="Center" />
      </controls:PixelSnapper>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsHighlighted" Value="True">
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundHighlightedBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="inputGestureTextBlock" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemDescriptionForegroundHighlightedBrushKey}}" Property="TextBlock.Foreground" />
      </Trigger>
      <Trigger Property="UIElement.IsEnabled" Value="False">
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="inputGestureTextBlock" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundDisabledBrushKey}}" Property="TextBlock.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsChecked" Value="True" />
          <Condition Property="MenuItem.Icon" Value="{x:Null}" />
        </MultiTrigger.Conditions>
        <Setter TargetName="icon" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuCheckGlyphTemplateKey}}" Property="ContentPresenter.ContentTemplate" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="1.0" />
      </MultiTrigger>
      <Trigger Property="MenuItem.InputGestureText" Value="{x:Null}">
        <Setter TargetName="spacerColumnDef" Property="ColumnDefinition.MinWidth" Value="0" />
      </Trigger>
      <Trigger Property="MenuItem.InputGestureText" Value="">
        <Setter TargetName="spacerColumnDef" Property="ColumnDefinition.MinWidth" Value="0" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="{x:Static themes:SharedResourceKeys.MenuItemSubmenuHeaderTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid Name="rootGrid" SnapsToDevicePixels="True">
      <Grid.ColumnDefinitions>
        <ColumnDefinition MinWidth="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemIconColumnWidthDoubleKey}}" Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemSpacerColumnGroup" />
        <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
        <ColumnDefinition MinWidth="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemPopupColumnWidthDoubleKey}}" Width="Auto" SharedSizeGroup="MenuItemPopupArrowColumnGroup" />
      </Grid.ColumnDefinitions>
      <controlsPrimitives:ElementChrome x:Name="chrome" Grid.ColumnSpan="5" Background="{TemplateBinding Control.Background}" BackgroundHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBackgroundHighlightedBrushKey}}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderHighlightedBrushKey}}" BorderThickness="{TemplateBinding Control.BorderThickness}" InnerBorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderNormalBrushKey}}" InnerBorderBrushHover="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderHighlightedBrushKey}}" InnerBorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemInnerBorderNormalThicknessKey}}" CornerRadius="{TemplateBinding themes:ThemeProperties.CornerRadius}" SnapsToDevicePixels="True" />
      <Border Name="checkPanel" Margin="2" Width="20" Height="20" Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBackgroundNormalBrushKey}}" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalBrushKey}}" BorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalThicknessKey}}" CornerRadius="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemGlyphBorderNormalCornerRadiusKey}}" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="True" Visibility="{Binding Path=IsChecked, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}" />
      <ContentPresenter Name="icon" Margin="2" MaxWidth="16" MaxHeight="16" ContentSource="Icon" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
      <controls:PixelSnapper Grid.Column="1" VerticalRoundMode="CeilingToEven">
        <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Control.Padding}" RecognizesAccessKey="True" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
      </controls:PixelSnapper>
      <ContentPresenter Grid.Column="4" Margin="1,1,0,0" ContentTemplate="{DynamicResource {x:Static themes:SharedResourceKeys.MenuPopupGlyphTemplateKey}}" TextElement.Foreground="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemPopupGlyphBackgroundNormalBrushKey}}" HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="True" />
      <Popup Name="PART_Popup" Grid.ColumnSpan="5" AllowsTransparency="True" Placement="Right" HorizontalOffset="-2" Focusable="False" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" themes:ThemeProperties.CornerRadius="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalCornerRadiusKey}}" IsOpen="{Binding Path=IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}">
        <controlsPrimitives:ShadowChrome x:Name="shadow" Direction="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowDirectionDoubleKey}}" ShadowOpacity="{DynamicResource {x:Static themes:AssetResourceKeys.ShadowOpacityNormalDoubleKey}}" SnapsToDevicePixels="True">
          <Grid ClipToBounds="True">
            <Border Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBackgroundNormalBrushKey}}" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalBrushKey}}" BorderThickness="{DynamicResource {x:Static themes:AssetResourceKeys.PopupBorderNormalThicknessKey}}" SnapsToDevicePixels="True" CornerRadius="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius)}">
              <Grid>
                <Border BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupInnerBorderNormalBrushKey}}" BorderThickness="1" CornerRadius="{Binding ElementName=PART_Popup, Path=(themes:ThemeProperties.CornerRadius)}" />
                <ScrollViewer Margin="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupPaddingNormalThicknessKey}}" CanContentScroll="True" Style="{DynamicResource {x:Static themes:SharedResourceKeys.MenuEmbeddedScrollViewerStyleKey}}">
                  <ContentControl Template="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemSubmenuContentTemplateKey}}" IsTabStop="False" RenderOptions.ClearTypeHint="Enabled">
                    <ItemsPresenter Name="ItemsPresenter" KeyboardNavigation.TabNavigation="Cycle" KeyboardNavigation.DirectionalNavigation="Cycle" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" Grid.IsSharedSizeScope="true" />
                  </ContentControl>
                </ScrollViewer>
              </Grid>
            </Border>
            <Border Name="transitionLine" Height="1" BorderThickness="1,0,1,0" BorderBrush="#00FFFFFF" Background="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupAnchorBackgroundOpenedBrushKey}}" HorizontalAlignment="Left" VerticalAlignment="Top" />
          </Grid>
        </controlsPrimitives:ShadowChrome>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsHighlighted" Value="True">
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Hover" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundHighlightedBrushKey}}" Property="TextElement.Foreground" />
      </Trigger>
      <Trigger Property="UIElement.IsEnabled" Value="False">
        <Setter TargetName="chrome" Property="controlsPrimitives:ElementChrome.State" Value="Disabled" />
        <Setter TargetName="rootGrid" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundDisabledBrushKey}}" Property="TextElement.Foreground" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="0.4" />
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsChecked" Value="True" />
          <Condition Property="MenuItem.Icon" Value="{x:Null}" />
        </MultiTrigger.Conditions>
        <Setter TargetName="icon" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuCheckGlyphTemplateKey}}" Property="ContentPresenter.ContentTemplate" />
        <Setter TargetName="icon" Property="UIElement.Opacity" Value="1.0" />
      </MultiTrigger>
      <Trigger Property="MenuItem.IsSuspendingPopupAnimation" Value="True">
        <Setter TargetName="PART_Popup" Property="Popup.PopupAnimation" Value="None" />
      </Trigger>
      <Trigger SourceName="PART_Popup" Property="Popup.HasDropShadow" Value="True">
        <Setter TargetName="shadow" Value="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowElevationInt32Key}}" Property="controlsPrimitives:ShadowChrome.Elevation" />
        <Setter TargetName="shadow" Property="FrameworkElement.Margin" Value="{Binding ElementName=shadow, Path=ShadowThickness}" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <Style x:Key="{x:Static themes:SharedResourceKeys.MenuItemStyleKey}" TargetType="{x:Type MenuItem}">
    <Setter Property="Background" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBackgroundNormalBrushKey}}" />
    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderNormalBrushKey}}" />
    <Setter Property="BorderThickness" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderNormalThicknessKey}}" />
    <Setter Property="themes:ThemeProperties.CornerRadius" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemBorderNormalCornerRadiusKey}}" />
    <Setter Property="HorizontalContentAlignment" Value="Left" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Padding" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemPaddingNormalThicknessKey}}" />
    <Setter Property="FrameworkElement.OverridesDefaultStyle" Value="True" />
    <Setter Property="ScrollViewer.PanningMode" Value="Both" />
    <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
    <Style.Triggers>
      <Trigger Property="MenuItem.Role" Value="TopLevelHeader">
        <Setter Property="themes:ThemeProperties.CornerRadius" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBorderNormalCornerRadiusKey}}" />
        <Setter Property="Padding" Value="10,4" />
        <Setter Property="Template" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemTopLevelHeaderTemplateKey}}" />
      </Trigger>
      <Trigger Property="MenuItem.Role" Value="TopLevelItem">
        <Setter Property="themes:ThemeProperties.CornerRadius" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarButtonBorderNormalCornerRadiusKey}}" />
        <Setter Property="Padding" Value="10,4" />
        <Setter Property="Template" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemTopLevelItemTemplateKey}}" />
      </Trigger>
      <Trigger Property="MenuItem.Role" Value="SubmenuHeader">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" />
        <Setter Property="Template" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemSubmenuHeaderTemplateKey}}" />
      </Trigger>
      <Trigger Property="MenuItem.Role" Value="SubmenuItem">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" />
        <Setter Property="Template" Value="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemSubmenuItemTemplateKey}}" />
      </Trigger>
    </Style.Triggers>
  </Style>
  <Style x:Key="{x:Static themes:SharedResourceKeys.MenuHeadingStyleKey}" TargetType="{x:Type MenuItem}">
    <Setter Property="Background" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuHeadingBackgroundNormalBrushKey}}" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" />
    <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
    <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
    <Setter Property="Padding" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuHeadingPaddingNormalThicknessKey}}" />
    <Setter Property="FontWeight" Value="Bold" />
    <Setter Property="IsEnabled" Value="False" />
    <Setter Property="ScrollViewer.PanningMode" Value="Both" />
    <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type MenuItem}">
          <controls:PixelSnapper VerticalRoundMode="CeilingToEven">
            <Border Background="{TemplateBinding Control.Background}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderThickness="{TemplateBinding Control.BorderThickness}">
              <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Control.Padding}" VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
            </Border>
          </controls:PixelSnapper>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{x:Static themes:SharedResourceKeys.ContextMenuStyleKey}" TargetType="{x:Type ContextMenu}">
    <Setter Property="Background" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBackgroundNormalBrushKey}}" />
    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalBrushKey}}" />
    <Setter Property="BorderThickness" Value="{DynamicResource {x:Static themes:AssetResourceKeys.PopupBorderNormalThicknessKey}}" />
    <Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}" />
    <Setter Property="FontSize" Value="{DynamicResource {x:Static themes:AssetResourceKeys.DefaultFontSizeDoubleKey}}" />
    <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuItemForegroundNormalBrushKey}}" />
    <Setter Property="themes:ThemeProperties.CornerRadius" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupBorderNormalCornerRadiusKey}}" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="themes:ContextMenuThemeProperties.CanAdjustOffsetsForShadow" Value="True" />
    <Setter Property="Grid.IsSharedSizeScope" Value="True" />
    <Setter Property="ContextMenu.HasDropShadow" Value="{DynamicResource {x:Static SystemParameters.DropShadowKey}}" />
    <Setter Property="ScrollViewer.PanningMode" Value="Both" />
    <Setter Property="Stylus.IsFlicksEnabled" Value="False" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ContextMenu}">
          <controlsPrimitives:ShadowChrome x:Name="shadow" Direction="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowDirectionDoubleKey}}" ShadowOpacity="{DynamicResource {x:Static themes:AssetResourceKeys.ShadowOpacityNormalDoubleKey}}" SnapsToDevicePixels="True">
            <Border Name="border" Background="{TemplateBinding Control.Background}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderThickness="{TemplateBinding Control.BorderThickness}" SnapsToDevicePixels="True">
              <Grid>
                <Border Name="innerBorder" BorderBrush="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupInnerBorderNormalBrushKey}}" BorderThickness="1" />
                <ScrollViewer Margin="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPopupPaddingNormalThicknessKey}}" CanContentScroll="True" Style="{DynamicResource {x:Static themes:SharedResourceKeys.MenuEmbeddedScrollViewerStyleKey}}">
                  <ContentControl Template="{DynamicResource {x:Static themes:SharedResourceKeys.MenuItemSubmenuContentTemplateKey}}" IsTabStop="False" RenderOptions.ClearTypeHint="Enabled">
                    <ItemsPresenter Name="ItemsPresenter" KeyboardNavigation.TabNavigation="Cycle" KeyboardNavigation.DirectionalNavigation="Cycle" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" Grid.IsSharedSizeScope="true" />
                  </ContentControl>
                </ScrollViewer>
              </Grid>
            </Border>
          </controlsPrimitives:ShadowChrome>
          <ControlTemplate.Triggers>
            <Trigger Property="ContextMenu.HasDropShadow" Value="True">
              <Setter TargetName="shadow" Value="{DynamicResource {x:Static themes:AssetResourceKeys.PopupShadowElevationInt32Key}}" Property="controlsPrimitives:ShadowChrome.Elevation" />
              <Setter TargetName="shadow" Property="Margin" Value="{Binding ElementName=shadow, Path=ShadowThickness}" />
              <Setter TargetName="border" Property="Border.CornerRadius" Value="{Binding Path=(themes:ThemeProperties.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}" />
              <Setter TargetName="innerBorder" Property="Border.CornerRadius" Value="{Binding Path=(themes:ThemeProperties.CornerRadius), RelativeSource={RelativeSource TemplatedParent}}" />
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{x:Static themes:SharedResourceKeys.MenuStyleKey}" TargetType="{x:Type Menu}">
    <Setter Property="Background" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuBackgroundNormalBrushKey}}" />
    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuBorderNormalBrushKey}}" />
    <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuForegroundNormalBrushKey}}" />
    <Setter Property="Padding" Value="{DynamicResource {x:Static themes:AssetResourceKeys.MenuPaddingNormalThicknessKey}}" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Panel.ZIndex" Value="1" />
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Menu}">
          <Border Background="{TemplateBinding Control.Background}" BorderBrush="{TemplateBinding Control.BorderBrush}" BorderThickness="{TemplateBinding Control.BorderThickness}" Padding="{TemplateBinding Control.Padding}" SnapsToDevicePixels="True">
            <ItemsPresenter SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="{x:Type controls:TitleBarMenu}" TargetType="{x:Type controls:TitleBarMenu}" BasedOn="{StaticResource {x:Static themes:SharedResourceKeys.MenuStyleKey}}">
    <Setter Property="Background" Value="#00FFFFFF" />
    <Setter Property="Foreground" Value="{Binding Path=(TextElement.Foreground), RelativeSource={RelativeSource TemplatedParent}}" />
    <Setter Property="ItemsPanel">
      <Setter.Value>
        <ItemsPanelTemplate>
          <WrapPanel />
        </ItemsPanelTemplate>
      </Setter.Value>
    </Setter>
    <Setter Property="VerticalAlignment" Value="Center" />
  </Style>
  <Style x:Key="{x:Static themes:SharedResourceKeys.ToolBarEmbeddedMenuStyleKey}" TargetType="{x:Type Menu}" BasedOn="{StaticResource {x:Static themes:SharedResourceKeys.MenuStyleKey}}">
    <Setter Property="FrameworkElement.OverridesDefaultStyle" Value="True" />
    <Setter Property="Background" Value="{x:Null}" />
    <Setter Property="BorderBrush" Value="{x:Null}" />
    <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarMenuForegroundNormalBrushKey}}" />
    <Setter Property="Padding" Value="0" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="KeyboardNavigation.TabNavigation" Value="Continue" />
    <Style.Resources>
      <ResourceDictionary>
        <Style x:Key="{x:Type MenuItem}" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Static themes:SharedResourceKeys.MenuItemStyleKey}}">
          <Setter Property="Foreground" Value="{DynamicResource {x:Static themes:AssetResourceKeys.ToolBarMenuForegroundNormalBrushKey}}" />
          <Setter Property="FrameworkElement.OverridesDefaultStyle" Value="True" />
        </Style>
      </ResourceDictionary>
    </Style.Resources>
  </Style>
</ResourceDictionary>